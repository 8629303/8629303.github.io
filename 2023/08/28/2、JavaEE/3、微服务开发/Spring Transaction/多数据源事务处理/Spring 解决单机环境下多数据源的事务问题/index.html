<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Spring 解决单机环境下多数据源的事务问题 | Hexo</title>
  <meta name="keywords" content="">
  <meta name="description" content="Spring 解决单机环境下多数据源的事务问题 | Hexo">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="请不要自己写，Spring Boot非常实用的内置功能：https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;7417630844100231206  在 SpringBoot 框架中，内置了许多实用的功能，这些功能可以帮助开发者高效地开发和维护应用程序。 一、请求数据记录器SpringBoot 提供了一个内置的日志记录解决方案，通过 AbstractRequestLoggingFilter 可以记录请">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringBoot2.x 内置功能 - 内置过滤器和 AOP 工具类">
<meta property="og:url" content="https://8629303.github.io/2024/10/08/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot2.x%20%E5%86%85%E7%BD%AE%E5%8A%9F%E8%83%BD%20-%20%E5%86%85%E7%BD%AE%E8%BF%87%E6%BB%A4%E5%99%A8%E5%92%8C%20AOP%20%E5%B7%A5%E5%85%B7%E7%B1%BB/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="请不要自己写，Spring Boot非常实用的内置功能：https:&#x2F;&#x2F;juejin.cn&#x2F;post&#x2F;7417630844100231206  在 SpringBoot 框架中，内置了许多实用的功能，这些功能可以帮助开发者高效地开发和维护应用程序。 一、请求数据记录器SpringBoot 提供了一个内置的日志记录解决方案，通过 AbstractRequestLoggingFilter 可以记录请">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-10-08T08:44:19.743Z">
<meta property="article:modified_time" content="2024-10-21T16:29:03.856Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/blog/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/blog/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/blog/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/blog/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="/blog">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/blog/"
   class="avatar_target">
    <img class="avatar"
         src="/blog/img/avatar.jpg"/>
</a>
<div class="author">
    <span>John Doe</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/8629303"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:8629303@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=8629303&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="全部文章">全部文章
            
                <small>(172)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="数据库">
            
            数据库
            <small>(5)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="开发工具">
            <i class="fold iconfont icon-right"></i>
            开发工具
            <small>(16)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="开发工具&lt;---&gt;Maven">
            
            Maven
            <small>(8)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="面试篇">
            
            面试篇
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="中间件">
            <i class="fold iconfont icon-right"></i>
            中间件
            <small>(9)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="中间件&lt;---&gt;ElasticSearch">
            
            ElasticSearch
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="中间件&lt;---&gt;MongoDB">
            
            MongoDB
            <small>(2)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="中间件&lt;---&gt;RabbitMQ">
            
            RabbitMQ
            <small>(3)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="中间件&lt;---&gt;Redis">
            
            Redis
            <small>(3)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="JavaEE">
            <i class="fold iconfont icon-right"></i>
            JavaEE
            <small>(72)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="JavaEE&lt;---&gt;微服务开发">
            
            微服务开发
            <small>(66)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JavaEE&lt;---&gt;JavaWeb">
            
            JavaWeb
            <small>(2)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JavaEE&lt;---&gt;SSM框架">
            
            SSM框架
            <small>(4)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="JavaSE">
            <i class="fold iconfont icon-right"></i>
            JavaSE
            <small>(62)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="JavaSE&lt;---&gt;Java汇总篇">
            
            Java汇总篇
            <small>(28)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JavaSE&lt;---&gt;Java基础篇">
            
            Java基础篇
            <small>(8)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JavaSE&lt;---&gt;Java进阶篇">
            
            Java进阶篇
            <small>(4)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JavaSE&lt;---&gt;Java新特性">
            
            Java新特性
            <small>(17)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JavaSE&lt;---&gt;Java性能测试与安全">
            
            Java性能测试与安全
            <small>(5)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="Linux">
            <i class="fold iconfont icon-right"></i>
            Linux
            <small>(7)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="Linux&lt;---&gt;虚拟机工具">
            
            虚拟机工具
            <small>(2)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="Linux&lt;---&gt;Docker">
            
            Docker
            <small>(2)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="Linux&lt;---&gt;Kubernetes">
            
            Kubernetes
            <small>(2)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="Linux&lt;---&gt;Nginx">
            
            Nginx
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">关于</a>
        
        <a style="width: 50%"
                
                                           class="friends">友链</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="172">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">叶落阁</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2024/10/08/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot2.x%20%E5%86%85%E7%BD%AE%E5%8A%9F%E8%83%BD%20-%20%E5%86%85%E7%BD%AE%E8%BF%87%E6%BB%A4%E5%99%A8%E5%92%8C%20AOP%20%E5%B7%A5%E5%85%B7%E7%B1%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot2.x 内置功能 - 内置过滤器和 AOP 工具类">SpringBoot2.x 内置功能 - 内置过滤器和 AOP 工具类</span>
            <span class="post-date" title="2024-10-08 16:44:19">2024/10/08</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2024/10/08/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%E7%B3%BB%E5%88%97-%E5%85%A8%E7%BD%91%E6%9C%80%E5%85%A8%E7%9A%84%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4%E5%8F%B2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot系列-全网最全的版本变更史">SpringBoot系列-全网最全的版本变更史</span>
            <span class="post-date" title="2024-10-08 16:38:53">2024/10/08</span>
        </a>
        
        
        <a  class="全部文章 开发工具 Maven "
           href="/blog/2024/10/08/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven/Maven%20%E6%95%99%E7%A8%8B%E4%B9%8B%20%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%20&%20%E9%B8%A3%E8%B0%A2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Maven 教程之 参考文献 &amp; 鸣谢">Maven 教程之 参考文献 &amp; 鸣谢</span>
            <span class="post-date" title="2024-10-08 15:50:47">2024/10/08</span>
        </a>
        
        
        <a  class="全部文章 开发工具 "
           href="/blog/2024/10/07/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/GitHub%20%E5%AE%9E%E6%88%98%E6%8A%80%E5%B7%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="GitHub 实战技巧">GitHub 实战技巧</span>
            <span class="post-date" title="2024-10-07 15:55:34">2024/10/07</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2024/10/07/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot2.x%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AF%87%20-%20%E9%9B%86%E6%88%90%20HirakiCP%20%E4%B8%8E%20Druid%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot2.x 数据库篇 - 集成 HirakiCP 与 Druid 数据库连接池">SpringBoot2.x 数据库篇 - 集成 HirakiCP 与 Druid 数据库连接池</span>
            <span class="post-date" title="2024-10-07 14:19:43">2024/10/07</span>
        </a>
        
        
        <a  class="全部文章 开发工具 "
           href="/blog/2024/09/30/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/MacOS%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%8F%8A%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85%E5%8D%B8%E8%BD%BD/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="MacOS 开发环境搭建及软件安装卸载">MacOS 开发环境搭建及软件安装卸载</span>
            <span class="post-date" title="2024-09-30 23:56:52">2024/09/30</span>
        </a>
        
        
        <a  class="全部文章 开发工具 Maven "
           href="/blog/2024/09/30/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven/Maven%20%E6%95%99%E7%A8%8B%E4%B9%8B%20JDK%20%E7%89%88%E6%9C%AC%E9%BB%98%E8%AE%A4%E8%AE%BE%E7%BD%AE%20/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Maven 教程之 JDK 版本默认设置">Maven 教程之 JDK 版本默认设置</span>
            <span class="post-date" title="2024-09-30 16:37:08">2024/09/30</span>
        </a>
        
        
        <a  class="全部文章 开发工具 Maven "
           href="/blog/2024/09/26/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven/Maven%20%E6%95%99%E7%A8%8B%E4%B9%8B%20profiles%20%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Maven 教程之 profiles 多环境配置">Maven 教程之 profiles 多环境配置</span>
            <span class="post-date" title="2024-09-26 17:40:34">2024/09/26</span>
        </a>
        
        
        <a  class="全部文章 开发工具 Maven "
           href="/blog/2024/09/25/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven/Maven%20%E6%95%99%E7%A8%8B%E4%B9%8B%20plugin%20%E8%AF%A6%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Maven 教程之 plugin 详解">Maven 教程之 plugin 详解</span>
            <span class="post-date" title="2024-09-25 11:32:44">2024/09/25</span>
        </a>
        
        
        <a  class="全部文章 开发工具 Maven "
           href="/blog/2024/09/21/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven/Maven%20%E6%95%99%E7%A8%8B%E4%B9%8B%20pom.xml%20%E8%AF%A6%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Maven 教程之 pom.xml 详解">Maven 教程之 pom.xml 详解</span>
            <span class="post-date" title="2024-09-21 16:14:13">2024/09/21</span>
        </a>
        
        
        <a  class="全部文章 开发工具 Maven "
           href="/blog/2024/09/21/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven/Maven%20%E6%95%99%E7%A8%8B%E4%B9%8B%20settings.xml%20%E8%AF%A6%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Maven 教程之 settings.xml 详解">Maven 教程之 settings.xml 详解</span>
            <span class="post-date" title="2024-09-21 16:14:09">2024/09/21</span>
        </a>
        
        
        <a  class="全部文章 面试篇 "
           href="/blog/2024/08/27/0%E3%80%81%E9%9D%A2%E8%AF%95%E7%AF%87/%E9%9D%A2%E8%AF%95%E5%AE%9D%E5%85%B8%E6%B1%87%E6%80%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="面试宝典汇总">面试宝典汇总</span>
            <span class="post-date" title="2024-08-27 16:20:25">2024/08/27</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2024/08/26/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E8%87%AA%E5%AE%9A%E4%B9%89%E9%9B%86%E5%90%88%E5%B8%B8%E9%87%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 自定义集合常量">Java 自定义集合常量</span>
            <span class="post-date" title="2024-08-26 12:11:54">2024/08/26</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2024/08/26/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20MVC/SpringMVC%E4%B9%8B@InitBinder%E6%B3%A8%E8%A7%A3%EF%BC%88%E6%97%A5%E6%9C%9F%E8%BD%AC%E6%8D%A2%EF%BC%89/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringMVC之@InitBinder注解（日期转换）">SpringMVC之@InitBinder注解（日期转换）</span>
            <span class="post-date" title="2024-08-26 11:10:28">2024/08/26</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2024/08/21/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Transaction/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8B%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86/Java%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%BA%8B%E5%8A%A1%E6%8F%90%E4%BA%A4%E7%9A%84%E5%A4%84%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 多线程事务提交的处理">Java 多线程事务提交的处理</span>
            <span class="post-date" title="2024-08-21 16:32:52">2024/08/21</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2024/08/20/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%20Cache%20%E6%95%B4%E5%90%88%20Redis%20%E7%BC%93%E5%AD%98%E6%A1%86%E6%9E%B6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot Cache 整合 Redis 缓存框架">SpringBoot Cache 整合 Redis 缓存框架</span>
            <span class="post-date" title="2024-08-20 16:11:47">2024/08/20</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2024/08/16/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Transaction/Spring%20%E4%BA%8B%E5%8A%A1%E5%BA%94%E7%94%A8%E5%8F%8A%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring 事务应用及源码分析">Spring 事务应用及源码分析</span>
            <span class="post-date" title="2024-08-16 10:33:57">2024/08/16</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2024/08/16/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Transaction/Spring%20JDBC%20-%20NamedParameterJdbcTemplate/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring JDBC - NamedParameterJdbcTemplate">Spring JDBC - NamedParameterJdbcTemplate</span>
            <span class="post-date" title="2024-08-16 00:18:18">2024/08/16</span>
        </a>
        
        
        <a  class="全部文章 开发工具 "
           href="/blog/2024/07/18/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git%20&%20GitHub/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Git &amp; GitHub">Git &amp; GitHub</span>
            <span class="post-date" title="2024-07-18 10:34:58">2024/07/18</span>
        </a>
        
        
        <a  class="全部文章 开发工具 Maven "
           href="/blog/2024/06/28/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven/Maven%20%E5%AE%9E%E6%88%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Maven 实战">Maven 实战</span>
            <span class="post-date" title="2024-06-28 16:50:35">2024/06/28</span>
        </a>
        
        
        <a  class="全部文章 数据库 "
           href="/blog/2024/06/26/3%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93/%E9%9D%A2%E8%AF%95%E5%AE%98%EF%BC%9A%E4%B8%8D%E4%BC%9A%E7%9C%8B%20Explain%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92%EF%BC%8C%E7%AE%80%E5%8E%86%E6%95%A2%E5%86%99%20SQL%20%E4%BC%98%E5%8C%96%EF%BC%9F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="面试官：不会看 Explain执行计划，简历敢写 SQL 优化？">面试官：不会看 Explain执行计划，简历敢写 SQL 优化？</span>
            <span class="post-date" title="2024-06-26 19:33:03">2024/06/26</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2024/04/22/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AF%87%E4%B9%8B%20IDEA%20-%20VM%20Options%E3%80%81Program%20Arguments%E3%80%81Environment%20Variable%20%E8%A7%A3%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 命令行篇之 IDEA - VM Options、Program Arguments、Environment Variable 解析">Java 命令行篇之 IDEA - VM Options、Program Arguments、Environment Variable 解析</span>
            <span class="post-date" title="2024-04-22 10:53:10">2024/04/22</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2024/04/19/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-%E9%85%8D%E7%BD%AE%E5%A4%96%E9%83%A8%E5%8C%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 配置文件-配置外部化">SpringBoot 2.x 配置文件-配置外部化</span>
            <span class="post-date" title="2024-04-19 09:18:55">2024/04/19</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2024/04/16/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%8E%9F%E7%90%86%E7%AF%87%E4%B9%8B%20SPI%20%E6%9C%BA%E5%88%B6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 原理篇之 SPI 机制">Java 原理篇之 SPI 机制</span>
            <span class="post-date" title="2024-04-16 17:26:15">2024/04/16</span>
        </a>
        
        
        <a  class="全部文章 开发工具 Maven "
           href="/blog/2024/01/14/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Maven/Maven%20%E6%95%99%E7%A8%8B%E4%B9%8B%20mirror%20&%20repository%20%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Maven 教程之 mirror &amp; repository 配置详解">Maven 教程之 mirror &amp; repository 配置详解</span>
            <span class="post-date" title="2024-01-14 22:51:03">2024/01/14</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/12/07/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E4%B8%BA%E4%BB%80%E4%B9%88SpringBoot%20jar%20%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%BF%90%E8%A1%8C/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 为什么SpringBoot jar 可以直接运行">SpringBoot 2.x 为什么SpringBoot jar 可以直接运行</span>
            <span class="post-date" title="2023-12-07 15:13:56">2023/12/07</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java基础篇 "
           href="/blog/2023/12/04/1%E3%80%81JavaSE/1.Java%20%E5%9F%BA%E7%A1%80%E7%AF%87/5%E3%80%81Java%20%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E8%BF%9B%E9%98%B6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 多线程进阶">Java 多线程进阶</span>
            <span class="post-date" title="2023-12-04 16:37:09">2023/12/04</span>
        </a>
        
        
        <a  class="全部文章 数据库 "
           href="/blog/2023/11/18/3%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BB%BA%E6%A8%A1%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="数据库建模工具汇总">数据库建模工具汇总</span>
            <span class="post-date" title="2023-11-18 15:31:11">2023/11/18</span>
        </a>
        
        
        <a  class="全部文章 JavaEE SSM框架 "
           href="/blog/2023/10/08/2%E3%80%81JavaEE/2%E3%80%81SSM%E6%A1%86%E6%9E%B6/Mybatis/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Mybatis">Mybatis</span>
            <span class="post-date" title="2023-10-08 19:45:47">2023/10/08</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java性能测试与安全 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/5.Java%20%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%AE%89%E5%85%A8/Java%20%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E7%AF%87%E4%B9%8B%20%E5%8E%8B%E6%B5%8B%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 性能测试篇之 压测工具汇总">Java 性能测试篇之 压测工具汇总</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java性能测试与安全 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/5.Java%20%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%AE%89%E5%85%A8/Java%20%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E7%AF%87%E4%B9%8B%20%E9%AB%98%E5%B9%B6%E5%8F%91%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87%EF%BC%9AQPS%E3%80%81TPS%E3%80%81RT%E3%80%81%E5%B9%B6%E5%8F%91%E6%95%B0%E3%80%81%E5%90%9E%E5%90%90%E9%87%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 性能测试篇之 高并发性能指标：QPS、TPS、RT、并发数、吞吐量">Java 性能测试篇之 高并发性能指标：QPS、TPS、RT、并发数、吞吐量</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java性能测试与安全 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/5.Java%20%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%AE%89%E5%85%A8/Java%20%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E7%AF%87%E4%B9%8B%20JMH%20%E5%B7%A5%E5%85%B7%E7%B1%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 性能测试篇之 JMH 工具类">Java 性能测试篇之 JMH 工具类</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java性能测试与安全 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/5.Java%20%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%AE%89%E5%85%A8/Java%20%E5%AE%89%E5%85%A8%E7%AF%87%E4%B9%8B%20API%20%E6%8E%A5%E5%8F%A3%E9%98%B2%E6%AD%A2%E5%8F%82%E6%95%B0%E7%AF%A1%E6%94%B9%E5%92%8C%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 安全篇之 API 接口防止参数篡改和重放攻击">Java 安全篇之 API 接口防止参数篡改和重放攻击</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java性能测试与安全 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/5.Java%20%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%AE%89%E5%85%A8/Java%20%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E7%AF%87%E4%B9%8B%2048%E5%BC%A0%E5%9B%BE%E5%AD%A6%E4%BC%9A%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E3%80%81%E5%8E%8B%E6%B5%8B%E5%92%8C%E8%B0%83%E4%BC%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 性能测试篇之 48张图学会性能监控、压测和调优">Java 性能测试篇之 48张图学会性能监控、压测和调优</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 开发工具 "
           href="/blog/2023/08/28/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/IDEA%20%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="IDEA 基本使用">IDEA 基本使用</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 开发工具 "
           href="/blog/2023/08/28/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/IDEA%20%E5%BF%AB%E6%8D%B7%E9%94%AE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="IDEA 快捷键">IDEA 快捷键</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 开发工具 "
           href="/blog/2023/08/28/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/IDEA%20%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="IDEA 插件安装">IDEA 插件安装</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 开发工具 "
           href="/blog/2023/08/28/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/PostMan%20%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="PostMan 工具的使用">PostMan 工具的使用</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 开发工具 "
           href="/blog/2023/08/28/6%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Git">Git</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E4%BC%98%E5%8C%96%E7%AF%87%E4%B9%8B%20%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3%20%E6%A0%A1%E9%AA%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 优化篇之 自定义注解 校验数据库表中的数据不可重复">Java 优化篇之 自定义注解 校验数据库表中的数据不可重复</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%B7%A5%E5%85%B7%E7%AF%87%E4%B9%8B%20API%20%E6%8E%A5%E5%8F%A3%E5%85%8D%E8%B4%B9%20JSONPlaceholder/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 工具篇之 API 接口免费 JSONPlaceholder">Java 工具篇之 API 接口免费 JSONPlaceholder</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%B7%A5%E5%85%B7%E7%AF%87%E4%B9%8B%20%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E7%BB%9F%E8%AE%A1%E4%BB%A3%E7%A0%81%E8%80%97%E6%97%B6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 工具篇之 如何优雅的统计代码耗时">Java 工具篇之 如何优雅的统计代码耗时</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B9%8B%20%E4%B8%8D%E5%8F%AF%E4%B8%8D%E7%9F%A5%E7%9A%84%207%20%E4%B8%AA%20JDK%20%E5%91%BD%E4%BB%A4/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 命令行之 不可不知的 7 个 JDK 命令">Java 命令行之 不可不知的 7 个 JDK 命令</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%AF%87%E4%B9%8B%20Window%20%E5%90%8E%E5%8F%B0%E5%90%AF%E5%8A%A8%20JAR%20%E7%A8%8B%E5%BA%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 命令行篇之 Window 后台启动 JAR 程序">Java 命令行篇之 Window 后台启动 JAR 程序</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%B7%A5%E5%85%B7%E7%AF%87%E4%B9%8B%20API%20%E6%96%87%E6%A1%A3%E5%B7%A5%E5%85%B7%20Swagger3.x-2.x/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 工具篇之 API 文档工具 Swagger3.x-2.x">Java 工具篇之 API 文档工具 Swagger3.x-2.x</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%B7%A5%E5%85%B7%E7%AF%87%E4%B9%8B%20Lombok/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 工具篇之 Lombok">Java 工具篇之 Lombok</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%B7%A5%E5%85%B7%E7%AF%87%E4%B9%8B%20%E6%8E%8C%E6%8F%A114%E7%A7%8DUML%E5%9B%BE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 工具篇之 掌握14种UML图">Java 工具篇之 掌握14种UML图</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%B7%A5%E5%85%B7%E7%B1%BB%E4%B9%8B%20%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B7%A5%E5%85%B7%E7%B1%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 工具类之 自定义工具类">Java 工具类之 自定义工具类</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20Bean%20%E4%B9%8B%20DTO%E3%80%81VO%E3%80%81PO%E3%80%81DO%E3%80%81BO%20%E7%B1%BB%E7%9A%84%E5%8C%BA%E5%88%AB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java Bean 之 DTO、VO、PO、DO、BO 类的区别">Java Bean 之 DTO、VO、PO、DO、BO 类的区别</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20JSON%20%E7%AF%87%E4%B9%8B%20Jackson/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java JSON 篇之 Jackson">Java JSON 篇之 Jackson</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20JSON%20%E7%AF%87%E4%B9%8B%20Gson/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java JSON 篇之 Gson">Java JSON 篇之 Gson</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Curl%20%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8F%8A%E5%91%BD%E4%BB%A4%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Curl 的使用及命令参数说明">Curl 的使用及命令参数说明</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20JSON%20%E7%AF%87%E4%B9%8B%20FastJson/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java JSON 篇之 FastJson">Java JSON 篇之 FastJson</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 中间件 Redis "
           href="/blog/2023/08/28/5%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6/Redis/backup/Redis6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Redis6">Redis6</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 中间件 Redis "
           href="/blog/2023/08/28/5%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6/Redis/Redis-%E6%9C%80%E5%85%A8%E5%AE%9E%E6%88%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Redis-最全实战">Redis-最全实战</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 中间件 Redis "
           href="/blog/2023/08/28/5%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6/Redis/Redis-%E4%BB%A3%E7%A0%81%E5%AE%9E%E6%88%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Redis-代码实战">Redis-代码实战</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 中间件 RabbitMQ "
           href="/blog/2023/08/28/5%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6/RabbitMQ/RabbitMQ-3.8.14/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="RabbitMQ-3.8.14">RabbitMQ-3.8.14</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 中间件 RabbitMQ "
           href="/blog/2023/08/28/5%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6/RabbitMQ/RabbitMQ-3.7.x/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="RabbitMQ-3.7.x">RabbitMQ-3.7.x</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 中间件 RabbitMQ "
           href="/blog/2023/08/28/5%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6/RabbitMQ/RabbitMQ-3.8.14-%E5%8D%9A%E5%AE%A2%E7%89%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="RabbitMQ-3.8.14-博客版">RabbitMQ-3.8.14-博客版</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 中间件 MongoDB "
           href="/blog/2023/08/28/5%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6/MongoDB/MongDB-4.4.2-%E5%8D%9A%E5%AE%A2%E7%89%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="MongDB-4.4.2-博客版">MongDB-4.4.2-博客版</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 中间件 MongoDB "
           href="/blog/2023/08/28/5%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6/MongoDB/MongDB-4.4.2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="MongDB-4.4.2">MongDB-4.4.2</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 中间件 ElasticSearch "
           href="/blog/2023/08/28/5%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6/ElasticSearch/ElasticSearch7.6.x%E5%AE%9E%E6%88%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ElasticSearch7.6.x实战">ElasticSearch7.6.x实战</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 Linux 虚拟机工具 "
           href="/blog/2023/08/28/4%E3%80%81Linux/%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B7%A5%E5%85%B7/Virtualbox%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE%E6%88%96%E9%85%8D%E7%BD%AE/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Virtualbox网络设置或配置">Virtualbox网络设置或配置</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 Linux 虚拟机工具 "
           href="/blog/2023/08/28/4%E3%80%81Linux/%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B7%A5%E5%85%B7/Virtualbox%E5%AE%89%E8%A3%85Centos7%E5%AE%9E%E6%88%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Virtualbox安装Centos7实战">Virtualbox安装Centos7实战</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 Linux Kubernetes "
           href="/blog/2023/08/28/4%E3%80%81Linux/Kubernetes/Minikube-k8s/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Minikube-k8s">Minikube-k8s</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 Linux Kubernetes "
           href="/blog/2023/08/28/4%E3%80%81Linux/Kubernetes/k0s%20%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B%EF%BC%9A%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%20Kubernetes%20%E9%9B%86%E7%BE%A4/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="k0s 使用教程：如何快速搭建 Kubernetes 集群">k0s 使用教程：如何快速搭建 Kubernetes 集群</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 Linux Nginx "
           href="/blog/2023/08/28/4%E3%80%81Linux/Nginx/Nginx-1.8.0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Nginx-1.8.0">Nginx-1.8.0</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 Linux Docker "
           href="/blog/2023/08/28/4%E3%80%81Linux/Docker/Docker%E5%88%9D%E7%BA%A7%E5%88%B0%E5%AE%9E%E6%88%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Docker初级到实战">Docker初级到实战</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 Linux Docker "
           href="/blog/2023/08/28/4%E3%80%81Linux/Docker/Docker&Docker-Compose%E5%AE%9E%E6%88%98-%E5%93%88%E5%96%BD%E6%B2%83%E5%BE%B7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Docker&amp;Docker-Compose实战-哈喽沃德">Docker&amp;Docker-Compose实战-哈喽沃德</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring/Spring%20Bean%20%E7%9A%84%E5%8A%A8%E6%80%81%E5%88%9B%E5%BB%BA%E8%8E%B7%E5%8F%96%E5%88%A0%E9%99%A4/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Bean 的动态创建获取删除">Spring Bean 的动态创建获取删除</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring/Spring%20Bean%20%E7%9A%8412%E7%A7%8D%E5%AE%9A%E4%B9%89%E6%96%B9%E6%B3%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Bean 的12种定义方法">Spring Bean 的12种定义方法</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring/Spring%20Bean%20%E6%B3%A8%E5%85%A5%E7%9A%843%E7%A7%8D%E6%96%B9%E5%BC%8F,%20%E4%B8%BA%E4%BD%95%E5%AE%98%E6%96%B9%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E5%99%A8%E6%B3%A8%E5%85%A5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Bean 注入的3种方式, 为何官方建议使用构造器注入">Spring Bean 注入的3种方式, 为何官方建议使用构造器注入</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Transaction/%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86/Spring%20%E8%A7%A3%E5%86%B3%E5%8D%95%E6%9C%BA%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E7%9A%84%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring 解决单机环境下多数据源的事务问题">Spring 解决单机环境下多数据源的事务问题</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Transaction/%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86/Spring%20%E5%AE%9E%E7%8E%B0%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E5%AE%9E%E6%88%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring 实现多数据源实战">Spring 实现多数据源实战</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Transaction/%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86/Spring%20%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E6%95%B0%E6%8D%AE%E6%BA%90%E3%80%81%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E5%88%87%E6%8D%A2%E6%96%B9%E5%BC%8F%E3%80%81%E5%A4%9A%E6%95%B0%E6%8D%AE%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring 实现动态数据源、多数据源切换方式、多数据事务管理">Spring 实现动态数据源、多数据源切换方式、多数据事务管理</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Transaction/Spring%20%E4%BA%8B%E5%8A%A1%E5%8E%9F%E7%90%86%E6%B7%B1%E5%85%A5%E4%B8%8E%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring 事务原理深入与分析">Spring 事务原理深入与分析</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Security/SpringSecurity/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringSecurity">SpringSecurity</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Transaction/JDBC/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="JDBC">JDBC</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Transaction/Spring%20JDBC%20-%20JdbcTemplate/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring JDBC - JdbcTemplate">Spring JDBC - JdbcTemplate</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Transaction/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8B%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86/JDBC%E6%89%B9%E5%A4%84%E7%90%86%E5%AE%9E%E7%8E%B0%E6%89%8B%E5%8A%A8%E4%BA%8B%E5%8A%A1%E6%8F%92%E5%85%A51000%E4%B8%87%E6%95%B0%E6%8D%AE%EF%BC%88%E5%8D%95%E7%BA%BF%E7%A8%8B%20&%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%89/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="JDBC批处理实现手动事务插入1000万数据（单线程 &amp; 多线程）">JDBC批处理实现手动事务插入1000万数据（单线程 &amp; 多线程）</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Data%20JPA/SpringData%20JPA%20%E7%B1%BB%E5%9B%BE%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E6%95%B4%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringData JPA 类图及使用方法整理">SpringData JPA 类图及使用方法整理</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Data%20JPA/SpringData%20JPA/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringData JPA">SpringData JPA</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Data%20JPA/Spring%20Data%20JPA%20%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E6%88%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Data JPA 原理与实战">Spring Data JPA 原理与实战</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Data%20JPA/Hibernata%20JPA/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hibernata JPA">Hibernata JPA</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Cloud%20Alibaba/SpringCloud%20Alibaba/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringCloud Alibaba">SpringCloud Alibaba</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot2.x%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AF%87%20-%20%E6%95%B4%E5%90%88H2%E6%95%B0%E6%8D%AE%E5%BA%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot2.x 数据库篇 - 整合H2数据库">SpringBoot2.x 数据库篇 - 整合H2数据库</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot2.x%20%E9%A1%B9%E7%9B%AE%E7%BB%9F%E4%B8%80%E6%9E%9A%E4%B8%BE%E8%BD%AC%E6%8D%A2%E5%AE%9E%E8%B7%B5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot2.x 项目统一枚举转换实践">SpringBoot2.x 项目统一枚举转换实践</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E5%AD%A6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot从零开始学">SpringBoot从零开始学</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%E9%85%8D%E7%BD%AE%E5%B1%9E%E6%80%A7%E4%B9%8BDataSource/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot配置属性之DataSource">SpringBoot配置属性之DataSource</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SprinigBoot%E6%96%87%E7%AB%A0%E6%91%98%E8%A6%81%E5%8F%8A%E8%BD%AC%E8%BD%BD/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SprinigBoot文章摘要及转载">SprinigBoot文章摘要及转载</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5%E7%9A%84%E5%BF%85%E8%A6%81%E6%80%A7%E5%92%8C%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="代码审查的必要性和最佳实践">代码审查的必要性和最佳实践</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B9%8B@Value%E8%BF%9B%E9%98%B6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 配置文件-读取配置文件之@Value进阶">SpringBoot 2.x 配置文件-读取配置文件之@Value进阶</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-%E8%AF%BB%E5%8F%96%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84N%E7%A7%8D%E6%96%B9%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 配置文件-读取配置文件的N种方式">SpringBoot 2.x 配置文件-读取配置文件的N种方式</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-%E8%AF%BB%E5%8F%96%20Resources%20%E6%96%87%E4%BB%B6%E4%B9%8B%E6%97%A0%E6%B3%95%E8%AF%BB%E5%8F%96Jar%E5%8C%85classpath%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 配置文件-读取 Resources 文件之无法读取Jar包classpath下的文件">SpringBoot 2.x 配置文件-读取 Resources 文件之无法读取Jar包classpath下的文件</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E7%BB%9F%E4%B8%80%E6%8E%A5%E5%8F%A3%E8%BF%94%E5%9B%9E%E6%A0%BC%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 统一接口返回格式">SpringBoot 2.x 统一接口返回格式</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-%E8%AF%BB%E5%8F%96%20Resources%20%E6%96%87%E4%BB%B6%E7%9A%84N%E7%A7%8D%E6%96%B9%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 配置文件-读取 Resources 文件的N种方式">SpringBoot 2.x 配置文件-读取 Resources 文件的N种方式</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B%E7%AF%87-%E6%8B%A6%E6%88%AA%E5%99%A8%E8%BF%87%E6%BB%A4%E5%99%A8%E4%B8%8E%E7%9B%91%E5%90%AC%E5%99%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 切面编程篇-拦截器过滤器与监听器">SpringBoot 2.x 切面编程篇-拦截器过滤器与监听器</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%AE%89%E5%85%A8%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E5%8A%A0%E8%A7%A3%E5%AF%86%E7%AE%97%E6%B3%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 安全密码学之加解密算法">SpringBoot 2.x 安全密码学之加解密算法</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3%E5%A4%A7%E5%85%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 常用注解大全">SpringBoot 2.x 常用注解大全</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3%E8%AF%A6%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 常用注解详解">SpringBoot 2.x 常用注解详解</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%90%AF%E5%8A%A8%E6%97%B6%E5%8A%A0%E8%BD%BD%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84N%E7%A7%8D%E6%96%B9%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 启动时加载初始化的N种方式">SpringBoot 2.x 启动时加载初始化的N种方式</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%8F%8A%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%E8%BF%87%E7%A8%8B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 启动流程及自动装配过程">SpringBoot 2.x 启动流程及自动装配过程</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%8A%A8%E6%80%81%E8%A3%85%E9%85%8DBean%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 动态装配Bean的三种方式">SpringBoot 2.x 动态装配Bean的三种方式</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%88%A9%E5%99%A8-1%20JUnit5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 单元测试利器-1 JUnit5">SpringBoot 2.x 单元测试利器-1 JUnit5</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%88%A9%E5%99%A8-3%20MockMvc/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 单元测试利器-3 MockMvc">SpringBoot 2.x 单元测试利器-3 MockMvc</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%88%A9%E5%99%A8-2%20Mockito/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 单元测试利器-2 Mockito">SpringBoot 2.x 单元测试利器-2 Mockito</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%88%86%E7%89%87%E4%B8%8A%E4%BC%A0%E3%80%81%E6%96%AD%E7%82%B9%E7%BB%AD%E4%BC%A0%E3%80%81%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E3%80%81%E7%A7%92%E4%BC%A0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 分片上传、断点续传、大文件上传、秒传">SpringBoot 2.x 分片上传、断点续传、大文件上传、秒传</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20Validation%20%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C%EF%BC%88TODO%EF%BC%89/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x Validation 参数校验（TODO）">SpringBoot 2.x Validation 参数校验（TODO）</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20WebMvcConfigurer%20%E8%AF%A6%E8%A7%A3%E3%80%90SpringMVC%E3%80%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x WebMvcConfigurer 详解【SpringMVC】">SpringBoot 2.x WebMvcConfigurer 详解【SpringMVC】</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20YML%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x YML配置文件详解">SpringBoot 2.x YML配置文件详解</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%A8%E5%B1%80%E5%94%AF%E4%B8%80ID%E7%94%9F%E6%88%90%E6%96%B9%E6%A1%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 分布式全局唯一ID生成方案">SpringBoot 2.x 分布式全局唯一ID生成方案</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20JWT%20%E6%A6%82%E5%BF%B5%E7%AF%87/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x JWT 概念篇">SpringBoot 2.x JWT 概念篇</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20Jar%20%E5%8C%85%E5%90%AF%E5%8A%A8%E3%80%81%E5%81%9C%E6%AD%A2%E3%80%81%E9%87%8D%E5%90%AF%E8%84%9A%E6%9C%AC/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x Jar 包启动、停止、重启脚本">SpringBoot 2.x Jar 包启动、停止、重启脚本</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20Java%20%E5%AE%9E%E7%8E%B0%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E7%9A%848%E7%A7%8D%E6%96%B9%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x Java 实现异步编程的8种方式">SpringBoot 2.x Java 实现异步编程的8种方式</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20Java%20%E7%A8%8B%E5%BA%8F%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0%E6%80%BB%E7%BB%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x Java 程序命令行参数总结">SpringBoot 2.x Java 程序命令行参数总结</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20@ConfigurationProperties%E4%BB%A5%E5%8F%8A@NestedConfigurationProperty%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x @ConfigurationProperties以及@NestedConfigurationProperty的使用详解">SpringBoot 2.x @ConfigurationProperties以及@NestedConfigurationProperty的使用详解</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20HTTP%20Headers%20%E5%A4%B4%E4%BF%A1%E6%81%AF%E8%AF%BB%E5%8F%96/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x HTTP Headers 头信息读取">SpringBoot 2.x HTTP Headers 头信息读取</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20HTTP%20Content-Type%20%E8%AF%A6%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x HTTP Content-Type 详解">SpringBoot 2.x HTTP Content-Type 详解</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20@ControllerAdvice%E4%B8%89%E7%A7%8D%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x @ControllerAdvice三种使用场景">SpringBoot 2.x @ControllerAdvice三种使用场景</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20JWT%20%E5%AE%9E%E6%88%98%E7%AF%87/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x JWT 实战篇">SpringBoot 2.x JWT 实战篇</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%20%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89%E6%80%A7%E5%AE%9E%E7%8E%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x  接口幂等性实现">SpringBoot 2.x  接口幂等性实现</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/Spring%20IO%20Platform%EF%BC%9A%E8%A7%A3%E5%86%B3%E4%BE%9D%E8%B5%96%E7%89%88%E6%9C%AC%E5%86%B2%E7%AA%81/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring IO Platform：解决依赖版本冲突">Spring IO Platform：解决依赖版本冲突</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Spring%20Boot/SpringBoot%202.x%20%E5%88%87%E9%9D%A2%E7%BC%96%E7%A8%8B%E7%AF%87-AOP%20%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8F%8A%E5%8E%9F%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringBoot 2.x 切面编程篇-AOP 的使用及原理">SpringBoot 2.x 切面编程篇-AOP 的使用及原理</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE SSM框架 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/2%E3%80%81SSM%E6%A1%86%E6%9E%B6/SpringMVC/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SpringMVC">SpringMVC</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Shiro/Shiro%E6%9D%83%E9%99%90%E5%AE%9E%E6%88%98%E8%AF%BE%E7%A8%8B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Shiro权限实战课程">Shiro权限实战课程</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE 微服务开发 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/3%E3%80%81%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91/Shiro/Shiro%E6%9D%83%E9%99%90%E5%AE%9E%E6%88%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Shiro权限实战">Shiro权限实战</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE SSM框架 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/2%E3%80%81SSM%E6%A1%86%E6%9E%B6/Spring/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring">Spring</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE SSM框架 "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/2%E3%80%81SSM%E6%A1%86%E6%9E%B6/MybatisPlus/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="MybatisPlus">MybatisPlus</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE JavaWeb "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/1%E3%80%81JavaWeb/%E4%BD%A0%E8%BF%98%E5%9C%A8%E4%B8%BA%20HTTP%20%E7%9A%84%E8%BF%99%E4%BA%9B%E6%A6%82%E5%BF%B5%E5%A4%B4%E7%96%BC%E5%90%97/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="你还在为 HTTP 的这些概念头疼吗">你还在为 HTTP 的这些概念头疼吗</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaEE JavaWeb "
           href="/blog/2023/08/28/2%E3%80%81JavaEE/1%E3%80%81JavaWeb/Cookie%E3%80%81Session%E3%80%81Token%E3%80%81JWT%E7%BB%88%E4%BA%8E%E8%AE%B2%E6%B8%85%E6%A5%9A%E4%BA%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Cookie、Session、Token、JWT终于讲清楚了">Cookie、Session、Token、JWT终于讲清楚了</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 数据库 "
           href="/blog/2023/08/28/3%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL-%E9%AB%98%E7%BA%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="MySQL-高级">MySQL-高级</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 数据库 "
           href="/blog/2023/08/28/3%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL-%E5%88%9D%E7%BA%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="MySQL-初级">MySQL-初级</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 数据库 "
           href="/blog/2023/08/28/3%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93/H2%20Database/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="H2 Database">H2 Database</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E4%BC%98%E5%8C%96%E7%AF%87%E4%B9%8B%20%E5%BB%B6%E6%97%B6%E9%98%9F%E5%88%97%20-%20%E8%AE%A2%E5%8D%95%E8%B6%85%E6%97%B6%E8%87%AA%E5%8A%A8%E5%8F%96%E6%B6%88%E7%9A%84N%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 优化篇之 延时队列 - 订单超时自动取消的N种实现方式">Java 优化篇之 延时队列 - 订单超时自动取消的N种实现方式</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E4%BC%98%E5%8C%96%E7%AF%87%E4%B9%8B%20%E6%B3%A8%E8%A7%A3%20+%20%E5%8F%8D%E5%B0%84%E6%B6%88%E9%99%A4%E9%87%8D%E5%A4%8D%E4%BB%A3%E7%A0%81/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 优化篇之 注解 + 反射消除重复代码">Java 优化篇之 注解 + 反射消除重复代码</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E9%9B%86%E5%90%88%E7%AF%87%E4%B9%8B%20%E8%8E%B7%E5%8F%96%E4%B8%A4%E4%B8%AA%E9%9B%86%E5%90%88List%E7%9A%84%E4%BA%A4%E9%9B%86%E3%80%81%E8%A1%A5%E9%9B%86%E3%80%81%E5%B9%B6%E9%9B%86%E3%80%81%E5%B7%AE%E9%9B%86%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 集合篇之 获取两个集合List的交集、补集、并集、差集的几种方式">Java 集合篇之 获取两个集合List的交集、补集、并集、差集的几种方式</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E4%BC%98%E5%8C%96%E7%AF%87%E4%B9%8B%20if-else%20%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 优化篇之 if-else 代码优化方案">Java 优化篇之 if-else 代码优化方案</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E5%90%84%E7%B1%BB%E5%9E%8B%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 日期时间各类型相互转换">Java 日期时间各类型相互转换</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E9%9B%86%E5%90%88%E7%AF%87%E4%B9%8B%20Lambda%20%E5%AE%9E%E7%8E%B0%E8%B6%85%E5%BC%BA%E6%8E%92%E5%BA%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 集合篇之 Lambda 实现超强排序">Java 集合篇之 Lambda 实现超强排序</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 动态代理">Java 动态代理</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E5%9F%BA%E6%9C%AC%E5%8A%9F%E7%AF%87%E4%B9%8B%20for%E3%80%81for-each%E3%80%81forEach()%20%E7%9A%84%20break%E3%80%81continue%E3%80%81return/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 基本功篇之 for、for-each、forEach() 的 break、continue、return">Java 基本功篇之 for、for-each、forEach() 的 break、continue、return</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6%E8%AF%A6%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 日志框架详解">Java 日志框架详解</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%20%E6%96%B0%E7%89%B9%E6%80%A7%E6%A6%82%E8%BF%B0%E5%8F%8A%E7%89%88%E6%9C%AC%E5%8F%91%E8%A1%8C%E5%8F%B2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 新特性概述及版本发行史">Java 新特性概述及版本发行史</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20Bean%20%E4%B9%8B%20Record%20%E7%B1%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java Bean 之 Record 类">Java Bean 之 Record 类</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java汇总篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/4.Java%20%E6%B1%87%E6%80%BB%E7%AF%87/Java%20%E4%BC%98%E5%8C%96%E7%AF%87%E4%B9%8B%20GZIP%E5%8E%8B%E7%BC%A9%E5%AD%97%E7%AC%A6%E4%B8%B2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 优化篇之 GZIP压缩字符串">Java 优化篇之 GZIP压缩字符串</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java进阶篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/2.Java%20%E8%BF%9B%E9%98%B6%E7%AF%87/JVM%20%E8%99%9A%E6%8B%9F%E6%9C%BA/Java%20GC%20%E6%80%BB%E7%BB%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java GC 总结">Java GC 总结</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%209%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%209%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 9 新特性">Java 9 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8B%20Stream%20%E6%B5%81/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 8 新特性之 Stream 流">Java 8 新特性之 Stream 流</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8B%20Optional%20%E7%B1%BB/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 8 新特性之 Optional 类">Java 8 新特性之 Optional 类</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 8 新特性">Java 8 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%208%20%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8B%20DateTime%20API/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 8 新特性之 DateTime API">Java 8 新特性之 DateTime API</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2018%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2018%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 18 新特性">Java 18 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2020%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2020%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 20 新特性">Java 20 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2019%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2019%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 19 新特性">Java 19 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2017%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2017%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 17 新特性">Java 17 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2015%E6%96%B0%E7%89%B9%E6%80%A7/Java%2015%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 15 新特性">Java 15 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2016%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2016%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 16 新特性">Java 16 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2013%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2013%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 13 新特性">Java 13 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2014%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2014%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 14 新特性">Java 14 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2010%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2010%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 10 新特性">Java 10 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2011%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2011%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 11 新特性">Java 11 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java新特性 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/3.Java%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2012%20%E6%96%B0%E7%89%B9%E6%80%A7/Java%2012%20%E6%96%B0%E7%89%B9%E6%80%A7/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 12 新特性">Java 12 新特性</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java基础篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/1.Java%20%E5%9F%BA%E7%A1%80%E7%AF%87/1%E3%80%81Java%20%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/Java%20%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 面向对象编程">Java 面向对象编程</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java基础篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/1.Java%20%E5%9F%BA%E7%A1%80%E7%AF%87/3%E3%80%81Java%20%E9%9B%86%E5%90%88%E7%B1%BB/Java%20%E7%B1%BB%E9%9B%86%E6%A1%86%E6%9E%B6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 类集框架">Java 类集框架</span>
            <span class="post-date" title="2023-08-28 09:23:45">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java基础篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/1.Java%20%E5%9F%BA%E7%A1%80%E7%AF%87/2%E3%80%81Java%20%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93/Java%20%E5%B8%B8%E7%94%A8%E7%B1%BB%E5%BA%93/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 常用类库">Java 常用类库</span>
            <span class="post-date" title="2023-08-28 09:23:44">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java基础篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/1.Java%20%E5%9F%BA%E7%A1%80%E7%AF%87/5%E3%80%81Java%20%E5%A4%9A%E7%BA%BF%E7%A8%8B/Java%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%9F%BA%E7%A1%80/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 多线程基础">Java 多线程基础</span>
            <span class="post-date" title="2023-08-28 09:23:44">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java基础篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/1.Java%20%E5%9F%BA%E7%A1%80%E7%AF%87/4%E3%80%81Java%20%E5%8F%8D%E5%B0%84%E4%B8%8E%E6%B3%A8%E8%A7%A3/Java%20%E5%8F%8D%E5%B0%84%E4%B8%8E%E6%B3%A8%E8%A7%A3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 反射与注解">Java 反射与注解</span>
            <span class="post-date" title="2023-08-28 09:23:44">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java基础篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/1.Java%20%E5%9F%BA%E7%A1%80%E7%AF%87/7%E3%80%81Java%20NIO%20%E6%B5%81/Java%20NIO%20%E6%B5%81/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java NIO 流">Java NIO 流</span>
            <span class="post-date" title="2023-08-28 09:23:44">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java基础篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/1.Java%20%E5%9F%BA%E7%A1%80%E7%AF%87/6%E3%80%81Java%20IO%20%E6%B5%81/Java%20IO%20%E6%B5%81/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java IO 流">Java IO 流</span>
            <span class="post-date" title="2023-08-28 09:23:44">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java进阶篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/2.Java%20%E8%BF%9B%E9%98%B6%E7%AF%87/Java%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Java%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java 设计模式">Java 设计模式</span>
            <span class="post-date" title="2023-08-28 09:23:44">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java进阶篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/2.Java%20%E8%BF%9B%E9%98%B6%E7%AF%87/JVM%20%E8%99%9A%E6%8B%9F%E6%9C%BA/7%20%E6%AE%B5%E5%B0%8F%E4%BB%A3%E7%A0%81%EF%BC%8C%E7%8E%A9%E8%BD%ACJava%E7%A8%8B%E5%BA%8F%E5%B8%B8%E8%A7%81%E7%9A%84%E5%B4%A9%E6%BA%83%E5%9C%BA%E6%99%AF/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="7 段小代码，玩转Java程序常见的崩溃场景">7 段小代码，玩转Java程序常见的崩溃场景</span>
            <span class="post-date" title="2023-08-28 09:23:44">2023/08/28</span>
        </a>
        
        
        <a  class="全部文章 JavaSE Java进阶篇 "
           href="/blog/2023/08/28/1%E3%80%81JavaSE/2.Java%20%E8%BF%9B%E9%98%B6%E7%AF%87/JVM%20%E8%99%9A%E6%8B%9F%E6%9C%BA/JVM%20%E8%99%9A%E6%8B%9F%E6%9C%BA/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="JVM 虚拟机">JVM 虚拟机</span>
            <span class="post-date" title="2023-08-28 09:23:44">2023/08/28</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-2、JavaEE/3、微服务开发/Spring Transaction/多数据源事务处理/Spring 解决单机环境下多数据源的事务问题" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Spring 解决单机环境下多数据源的事务问题</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="JavaEE">JavaEE</a> > 
            
            <a  data-rel="JavaEE&lt;---&gt;微服务开发">微服务开发</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2024-10-22 00:29:03'>2023-08-28 09:23</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot-%E5%8D%95%E6%9C%BA%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%8A%A8%E6%80%81%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E7%9A%84%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98"><span class="toc-text">SpringBoot 单机环境下动态多数据源的事务问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88%E5%8F%8A%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">一、事务实现方案及环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%80%E5%90%AF%E4%BA%8B%E5%8A%A1%E6%B3%A8%E8%A7%A3"><span class="toc-text">二、自定义开启事务注解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81YML-%E9%85%8D%E7%BD%AE%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-text">三、YML 配置多数据源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-text">四、多数据源配置类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-text">五、自定义数据源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E9%87%8D%E5%86%99-Connection-%E8%BF%9E%E6%8E%A5"><span class="toc-text">六、重写 Connection 连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%95%B0%E6%8D%AE%E6%BA%90%E7%AE%A1%E7%90%86-Context"><span class="toc-text">七、数据源管理 Context</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-Context"><span class="toc-text">八、事务管理 Context</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E5%86%99%E5%88%87%E9%9D%A2"><span class="toc-text">九、写切面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E6%B5%8B%E8%AF%95%E7%B1%BB"><span class="toc-text">十、测试类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot-%E5%8D%95%E6%9C%BA%E7%8E%AF%E5%A2%83%E4%B8%8B%E9%9D%99%E6%80%81%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E7%9A%84%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98"><span class="toc-text">SpringBoot 单机环境下静态多数据源的事务问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88"><span class="toc-text">一、事务实现方案</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%80%E5%90%AF%E4%BA%8B%E5%8A%A1%E6%B3%A8%E8%A7%A3-1"><span class="toc-text">二、自定义开启事务注解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81YML-%E9%85%8D%E7%BD%AE%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90-1"><span class="toc-text">三、YML 配置多数据源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE%E7%B1%BB-1"><span class="toc-text">四、多数据源配置类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E6%BA%90-1"><span class="toc-text">五、自定义数据源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E9%87%8D%E5%86%99-Connection-%E8%BF%9E%E6%8E%A5-1"><span class="toc-text">六、重写 Connection 连接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%95%B0%E6%8D%AE%E6%BA%90%E7%AE%A1%E7%90%86-Context-1"><span class="toc-text">七、数据源管理 Context</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86-Context-1"><span class="toc-text">八、事务管理 Context</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E5%86%99%E5%88%87%E9%9D%A2-1"><span class="toc-text">九、写切面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E6%B5%8B%E8%AF%95%E7%B1%BB-1"><span class="toc-text">十、测试类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot-JTA-Atomikos-%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E7%9A%84%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E8%AF%A6%E8%A7%A3"><span class="toc-text">SpringBoot JTA Atomikos 多数据源的分布式事务管理详解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E4%BB%8B%E7%BB%8D"><span class="toc-text">1、分布式事务介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81Atomikos-%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3"><span class="toc-text">2、Atomikos 参考文档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81Atomikos-%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D"><span class="toc-text">3、Atomikos 组件介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81JTA-AbstractRoutingDataSource-%E6%95%B0%E6%8D%AE%E6%BA%90%E5%88%87%E6%8D%A2%E5%A4%B1%E6%95%88"><span class="toc-text">4、JTA + AbstractRoutingDataSource 数据源切换失效</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E4%BA%8B%E5%8A%A1%E4%B8%8A%E4%B8%8B%E6%96%87%E7%9A%84%E7%BB%91%E5%AE%9A"><span class="toc-text">1、事务上下文的绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81JTA-%E5%85%A8%E5%B1%80%E4%BA%8B%E5%8A%A1%E7%9A%84%E7%89%B9%E6%80%A7"><span class="toc-text">2、JTA 全局事务的特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%A3%B0%E6%98%8E%E5%BC%8F%E4%BA%8B%E5%8A%A1%E4%B8%8E%E8%B7%AF%E7%94%B1%E7%AD%96%E7%95%A5%E7%9A%84%E5%86%B2%E7%AA%81"><span class="toc-text">3、声明式事务与路由策略的冲突</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">4、解决方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E6%9C%80%E7%BB%88%E6%80%BB%E7%BB%93"><span class="toc-text">5、最终总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot-%E4%BD%BF%E7%94%A8-JdbcTemplate-Atomikos-%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1"><span class="toc-text">SpringBoot 使用 JdbcTemplate + Atomikos 实现分布式事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96"><span class="toc-text">1、添加依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E5%9C%A8-application-yml-%E4%B8%AD%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90"><span class="toc-text">2、在 application.yml 中配置多个数据源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE"><span class="toc-text">3、第一个数据源配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E7%AC%AC%E4%BA%8C%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE"><span class="toc-text">4、第二个数据源配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81Atomikos-%E9%85%8D%E7%BD%AE%EF%BC%8C%E5%88%9B%E5%BB%BA-JTA-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-text">5、Atomikos 配置，创建 JTA 事务管理器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81%E7%BC%96%E5%86%99-Controller-%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E6%AD%A3%E5%B8%B8%E5%92%8C%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5"><span class="toc-text">6、编写 Controller 多数据源正常和异常情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81%E6%B5%8B%E8%AF%95%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E6%AD%A3%E5%B8%B8%E6%83%85%E5%86%B5"><span class="toc-text">7、测试多数据源正常情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81%E6%B5%8B%E8%AF%95%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5"><span class="toc-text">8、测试多数据源异常情况</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot-%E4%BD%BF%E7%94%A8-Mybatis-Atomikos-%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1"><span class="toc-text">SpringBoot 使用 Mybatis + Atomikos 实现分布式事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96-1"><span class="toc-text">1、添加依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E5%9C%A8-application-yml-%E4%B8%AD%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90-1"><span class="toc-text">2、在 application.yml 中配置多个数据源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE-1"><span class="toc-text">3、第一个数据源配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E7%AC%AC%E4%BA%8C%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE-1"><span class="toc-text">4、第二个数据源配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81Atomikos-%E9%85%8D%E7%BD%AE%EF%BC%8C%E5%88%9B%E5%BB%BA-JTA-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8-1"><span class="toc-text">5、Atomikos 配置，创建 JTA 事务管理器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81%E7%BC%96%E5%86%99%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E4%BD%93%E7%B1%BB%E4%BB%A5%E5%8F%8A-Mapper"><span class="toc-text">6、编写数据库实体类以及 Mapper</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81%E7%BC%96%E5%86%99-Controller-%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E6%AD%A3%E5%B8%B8%E5%92%8C%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5"><span class="toc-text">7、编写 Controller 多数据源正常和异常情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81%E6%B5%8B%E8%AF%95%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E6%AD%A3%E5%B8%B8%E6%83%85%E5%86%B5"><span class="toc-text">8、测试多数据源正常情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81%E6%B5%8B%E8%AF%95%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5"><span class="toc-text">9、测试多数据源异常情况</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot-%E4%BD%BF%E7%94%A8-JPA-Atomikos-%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1"><span class="toc-text">SpringBoot 使用 JPA + Atomikos 实现分布式事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96-2"><span class="toc-text">1、添加依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E5%9C%A8-application-yml-%E4%B8%AD%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90-2"><span class="toc-text">2、在 application.yml 中配置多个数据源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE-2"><span class="toc-text">3、第一个数据源配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E7%AC%AC%E4%BA%8C%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%BA%90%E9%85%8D%E7%BD%AE-2"><span class="toc-text">4、第二个数据源配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81Atomikos-%E9%85%8D%E7%BD%AE%EF%BC%8C%E5%88%9B%E5%BB%BA-JTA-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8-2"><span class="toc-text">5、Atomikos 配置，创建 JTA 事务管理器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81%E7%BC%96%E5%86%99-Entity-%E4%B8%8E-Repository"><span class="toc-text">6、编写 Entity 与 Repository</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81%E7%BC%96%E5%86%99-Controller-%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E6%AD%A3%E5%B8%B8%E5%92%8C%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5-1"><span class="toc-text">7、编写 Controller 多数据源正常和异常情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81%E6%B5%8B%E8%AF%95%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E6%AD%A3%E5%B8%B8%E6%83%85%E5%86%B5-1"><span class="toc-text">8、测试多数据源正常情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9%E3%80%81%E6%B5%8B%E8%AF%95%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5-1"><span class="toc-text">9、测试多数据源异常情况</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE-%E9%B8%A3%E8%B0%A2"><span class="toc-text">参考文献 &amp; 鸣谢</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SpringBoot-单机环境下动态多数据源的事务问题"><a href="#SpringBoot-单机环境下动态多数据源的事务问题" class="headerlink" title="SpringBoot 单机环境下动态多数据源的事务问题"></a>SpringBoot 单机环境下动态多数据源的事务问题</h1><blockquote>
<p>Java解决单机环境下多数据源的事务问题：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/fantongxue/p/16867228.html">https://www.cnblogs.com/fantongxue/p/16867228.html</a></p>
</blockquote>
<p>SpringBoot 单机环境下的 @Transictional 可以保证事务，但多数据源的情况就无法使用了，这里简单实现一下多数据源的情况下如何保证事务。</p>
<h2 id="一、事务实现方案及环境搭建"><a href="#一、事务实现方案及环境搭建" class="headerlink" title="一、事务实现方案及环境搭建"></a>一、事务实现方案及环境搭建</h2><p>1、利用 ThreadLocal 将事务方法 内用到的 connection 缓存起来，当业务执行完毕，再统一 commit 或者 rollback；</p>
<p><img src="/blog/Spring-%E8%A7%A3%E5%86%B3%E5%8D%95%E6%9C%BA%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90%E7%9A%84%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98.assets/image-20241017215309825.png"></p>
<p>2、pom.xml 文件如下</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.5.0&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;multi-database-transaction-static&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;MultiDatabaseTransaction&lt;/name&gt;
    &lt;description&gt;MultiDatabaseTransaction&lt;/description&gt;
    &lt;properties&gt;
        &lt;java.version&gt;11&lt;/java.version&gt;
    &lt;/properties&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!-- https://mvnrepository.com/artifact/com.h2database/h2 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.h2database&lt;/groupId&gt;
            &lt;artifactId&gt;h2&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;nexus-aliyun&lt;/id&gt;
            &lt;name&gt;nexus-aliyun&lt;/name&gt;
            &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;
            &lt;releases&gt;
                &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;/releases&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;

    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;public&lt;/id&gt;
            &lt;name&gt;aliyun nexus&lt;/name&gt;
            &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;
            &lt;releases&gt;
                &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;/releases&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;
&lt;/project&gt;
</code></pre>
<h2 id="二、自定义开启事务注解"><a href="#二、自定义开启事务注解" class="headerlink" title="二、自定义开启事务注解"></a>二、自定义开启事务注解</h2><pre><code class="java">package com.example.annotation;

import java.lang.annotation.*;

@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(&#123;ElementType.METHOD&#125;)
public @interface MultiDSTransaction &#123;
&#125;
</code></pre>
<h2 id="三、YML-配置多数据源"><a href="#三、YML-配置多数据源" class="headerlink" title="三、YML 配置多数据源"></a>三、YML 配置多数据源</h2><pre><code class="yaml">spring:
  datasource:
    datasource1:
      jdbc-url: jdbc:h2:mem:datasource1
      username: sa
      password: sa
      driverClassName: org.h2.Driver
    datasource2:
      jdbc-url: jdbc:h2:mem:datasource2
      username: sa
      password: sa
      driverClassName: org.h2.Driver
  h2:
    console:
      enabled: true
      path: /h2
      settings:
        web-allow-others: true
</code></pre>
<h2 id="四、多数据源配置类"><a href="#四、多数据源配置类" class="headerlink" title="四、多数据源配置类"></a>四、多数据源配置类</h2><p>使用了 @Primary 注解后，作用是将该bean设置为主要注入bean，当注入相同类型的datasource的bean时就不会注入DataSourceConfig配置类中注入的两个bean了，只会注入这个，mybatis 在使用 DataSourceUtil.getDataSource 的时候获取的是这个自定义数据源，执行的是此自定义数据源的 getConnection 方法。jdbcTemplate、JPA 也是同理。</p>
<pre><code class="java">package com.example.config;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Primary;
import javax.sql.DataSource;
import java.util.HashMap;
import java.util.Map;

/**
 * 注入两个数据源
 */
@Configuration
public class DataSourceConfig &#123;

    @Bean
    @ConfigurationProperties(prefix = &quot;spring.datasource.datasource1&quot;)
    public DataSource dataSource1()&#123;
        return DataSourceBuilder.create().build();
    &#125;

    @Bean
    @ConfigurationProperties(prefix = &quot;spring.datasource.datasource2&quot;)
    public DataSource dataSource2()&#123;
        return DataSourceBuilder.create().build();
    &#125;

    @Primary
    @Bean
    public DynamicDataSource dynamicDataSource() &#123;
        DynamicDataSource dynamicDataSource = new DynamicDataSource();
        Map&lt;Object, Object&gt; targetDataSources = new HashMap&lt;&gt;();
        targetDataSources.put(&quot;one&quot;, dataSource1());
        targetDataSources.put(&quot;two&quot;, dataSource2());
        // 设置默认数据源
        dynamicDataSource.setDefaultTargetDataSource(dataSource1());
        // 添加数据源集合
        dynamicDataSource.setTargetDataSources(targetDataSources);
        return dynamicDataSource;
    &#125;
&#125;
</code></pre>
<h2 id="五、自定义数据源"><a href="#五、自定义数据源" class="headerlink" title="五、自定义数据源"></a>五、自定义数据源</h2><p>在自定义数据源中注入上边那两个多数据源，维持多数据源执行事务期间用到的连接列表，在自定义数据源中添加事务相关业务，既在获取 连接的地方将 Connection 缓存到 ThreadLocal 中。</p>
<pre><code class="java">package com.example.config;

import com.example.util.DataSourceContext;
import com.example.util.TransactionContext;
import org.springframework.jdbc.datasource.lookup.AbstractRoutingDataSource;
import javax.sql.DataSource;
import java.sql.Connection;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class DynamicDataSource extends AbstractRoutingDataSource &#123;
    /**
     * 添加一个DataSources Map，用来获取数据源集合
     */
    private Map&lt;Object, Object&gt; targetDataSources = new HashMap&lt;&gt;();
    public Map&lt;Object, Object&gt; getTargetDataSources() &#123;
        return targetDataSources;
    &#125;

    /**
     * 重写setTargetDataSources方法，为了可以让自己得到
     * @param targetDataSources
     */
    @Override
    public void setTargetDataSources(Map&lt;Object, Object&gt; targetDataSources) &#123;
        this.targetDataSources.putAll(targetDataSources);
        super.setTargetDataSources(this.targetDataSources);
        super.afterPropertiesSet();// 必须添加该句，否则新添加数据源无法识别到
    &#125;

    /**
     * 必须实现该接口。用来获取当前数据源
     */
    @Override
    protected Object determineCurrentLookupKey() &#123;
        // 或者return null.细节看源码AbstractRoutingDataSource.determineTargetDataSource
        return DataSourceContext.getDataSource();
    &#125;

    @Override
    public Connection getConnection() throws SQLException &#123;
        // 获取当前数据源连接
        String currentDataSourceKey = DataSourceContext.getDataSource();
        DataSource currentDataSource = (DataSource) targetDataSources.get(currentDataSourceKey);
        Connection connection = currentDataSource.getConnection();

        // 获取自定义数据库连接
        CustomConnection customConnection = new CustomConnection(connection);
        if (TransactionContext.isOpenTran()) &#123;
            customConnection.setAutoCommit(false);
            List&lt;CustomConnection&gt; customConnections = TransactionContext.MULTI_TRAN_CONNECTION.get();
            if (customConnections == null) &#123;
                customConnections = new ArrayList&lt;&gt;();
            &#125;
            customConnections.add(customConnection);
            TransactionContext.MULTI_TRAN_CONNECTION.set(customConnections);
        &#125;
        return customConnection;
    &#125;
&#125;
</code></pre>
<h2 id="六、重写-Connection-连接"><a href="#六、重写-Connection-连接" class="headerlink" title="六、重写 Connection 连接"></a>六、重写 Connection 连接</h2><pre><code class="java">package com.example.config;

import com.example.util.TransactionContext;
import java.sql.*;
import java.util.Map;
import java.util.Properties;
import java.util.concurrent.Executor;

public class CustomConnection implements Connection &#123;
    // 真实的连接
    private Connection connection;

    public CustomConnection(Connection connection) &#123;
        this.connection = connection;
    &#125;
    @Override
    public void commit() throws SQLException &#123;
        // 如果没开启多数据源事务，则走 commit
        if (!TransactionContext.isOpenTran()) &#123;
            connection.commit();
        &#125;
    &#125;

    @Override
    public void rollback() throws SQLException &#123;
        connection.rollback();
    &#125;

    public void commitMultiDbTran() throws SQLException &#123;
        // 如果开启多数据源，则走 这里的 commit
        connection.commit();
    &#125;
    @Override
    public void close() throws SQLException &#123;
        // mybatis 执行完业务后，会触发 close() 操作，如果 connection 被提前 close 了，业务就会出错
        if (!TransactionContext.isOpenTran()) &#123;
            connection.close();
        &#125;
    &#125;
    public void closeMultiDbTran() throws SQLException &#123;
        // 如果开启多数据源事务，则走 这里的 close
        connection.close();
    &#125;

    @Override
    public Statement createStatement() throws SQLException &#123;
        return connection.createStatement();
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql) throws SQLException &#123;
        return connection.prepareStatement(sql);
    &#125;

    @Override
    public CallableStatement prepareCall(String sql) throws SQLException &#123;
        return connection.prepareCall(sql);
    &#125;

    @Override
    public String nativeSQL(String sql) throws SQLException &#123;
        return connection.nativeSQL(sql);
    &#125;

    @Override
    public void setAutoCommit(boolean autoCommit) throws SQLException &#123;
        connection.setAutoCommit(autoCommit);
    &#125;

    @Override
    public boolean getAutoCommit() throws SQLException &#123;
        return connection.getAutoCommit();
    &#125;

    @Override
    public boolean isClosed() throws SQLException &#123;
        return connection.isClosed();
    &#125;

    @Override
    public DatabaseMetaData getMetaData() throws SQLException &#123;
        return connection.getMetaData();
    &#125;

    @Override
    public void setReadOnly(boolean readOnly) throws SQLException &#123;
        connection.setReadOnly(readOnly);
    &#125;

    @Override
    public boolean isReadOnly() throws SQLException &#123;
        return connection.isReadOnly();
    &#125;

    @Override
    public void setCatalog(String catalog) throws SQLException &#123;
        connection.setCatalog(catalog);
    &#125;

    @Override
    public String getCatalog() throws SQLException &#123;
        return connection.getCatalog();
    &#125;

    @Override
    public void setTransactionIsolation(int level) throws SQLException &#123;
        connection.setTransactionIsolation(level);
    &#125;

    @Override
    public int getTransactionIsolation() throws SQLException &#123;
        return connection.getTransactionIsolation();
    &#125;

    @Override
    public SQLWarning getWarnings() throws SQLException &#123;
        return connection.getWarnings();
    &#125;

    @Override
    public void clearWarnings() throws SQLException &#123;
        connection.clearWarnings();
    &#125;

    @Override
    public Statement createStatement(int resultSetType, int resultSetConcurrency) throws SQLException &#123;
        return connection.createStatement(resultSetType,resultSetConcurrency);
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql, int resultSetType, int resultSetConcurrency) throws SQLException &#123;
        return connection.prepareStatement(sql,resultSetType,resultSetConcurrency);
    &#125;

    @Override
    public CallableStatement prepareCall(String sql, int resultSetType, int resultSetConcurrency) throws SQLException &#123;
        return connection.prepareCall(sql,resultSetType,resultSetConcurrency);
    &#125;

    @Override
    public Map&lt;String, Class&lt;?&gt;&gt; getTypeMap() throws SQLException &#123;
        return connection.getTypeMap();
    &#125;

    @Override
    public void setTypeMap(Map&lt;String, Class&lt;?&gt;&gt; map) throws SQLException &#123;
        connection.setTypeMap(map);
    &#125;

    @Override
    public void setHoldability(int holdability) throws SQLException &#123;
        connection.setHoldability(holdability);
    &#125;

    @Override
    public int getHoldability() throws SQLException &#123;
        return connection.getHoldability();
    &#125;

    @Override
    public Savepoint setSavepoint() throws SQLException &#123;
        return connection.setSavepoint();
    &#125;

    @Override
    public Savepoint setSavepoint(String name) throws SQLException &#123;
        return connection.setSavepoint(name);
    &#125;

    @Override
    public void rollback(Savepoint savepoint) throws SQLException &#123;
        connection.rollback(savepoint);
    &#125;

    @Override
    public void releaseSavepoint(Savepoint savepoint) throws SQLException &#123;
        connection.releaseSavepoint(savepoint);
    &#125;

    @Override
    public Statement createStatement(int resultSetType, int resultSetConcurrency, int resultSetHoldability) throws SQLException &#123;
        return connection.createStatement(resultSetType,resultSetConcurrency,resultSetHoldability);
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql, int resultSetType, int resultSetConcurrency, int resultSetHoldability) throws SQLException &#123;
        return connection.prepareStatement(sql,resultSetType,resultSetConcurrency,resultSetHoldability);
    &#125;

    @Override
    public CallableStatement prepareCall(String sql, int resultSetType, int resultSetConcurrency, int resultSetHoldability) throws SQLException &#123;
        return connection.prepareCall(sql,resultSetType,resultSetConcurrency,resultSetHoldability);
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql, int autoGeneratedKeys) throws SQLException &#123;
        return connection.prepareStatement(sql,autoGeneratedKeys);
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql, int[] columnIndexes) throws SQLException &#123;
        return connection.prepareStatement(sql,columnIndexes);
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql, String[] columnNames) throws SQLException &#123;
        return connection.prepareStatement(sql,columnNames);
    &#125;

    @Override
    public Clob createClob() throws SQLException &#123;
        return connection.createClob();
    &#125;

    @Override
    public Blob createBlob() throws SQLException &#123;
        return connection.createBlob();
    &#125;

    @Override
    public NClob createNClob() throws SQLException &#123;
        return connection.createNClob();
    &#125;

    @Override
    public SQLXML createSQLXML() throws SQLException &#123;
        return connection.createSQLXML();
    &#125;

    @Override
    public boolean isValid(int timeout) throws SQLException &#123;
        return connection.isValid(timeout);
    &#125;

    @Override
    public void setClientInfo(String name, String value) throws SQLClientInfoException &#123;
        connection.setClientInfo(name,value);
    &#125;

    @Override
    public void setClientInfo(Properties properties) throws SQLClientInfoException &#123;
        connection.setClientInfo(properties);
    &#125;

    @Override
    public String getClientInfo(String name) throws SQLException &#123;
        return connection.getClientInfo(name);
    &#125;

    @Override
    public Properties getClientInfo() throws SQLException &#123;
        return connection.getClientInfo();
    &#125;

    @Override
    public Array createArrayOf(String typeName, Object[] elements) throws SQLException &#123;
        return connection.createArrayOf(typeName,elements);
    &#125;

    @Override
    public Struct createStruct(String typeName, Object[] attributes) throws SQLException &#123;
        return connection.createStruct(typeName,attributes);
    &#125;

    @Override
    public void setSchema(String schema) throws SQLException &#123;
        connection.setSchema(schema);
    &#125;

    @Override
    public String getSchema() throws SQLException &#123;
        return connection.getSchema();
    &#125;

    @Override
    public void abort(Executor executor) throws SQLException &#123;
        connection.abort(executor);
    &#125;

    @Override
    public void setNetworkTimeout(Executor executor, int milliseconds) throws SQLException &#123;
        connection.setNetworkTimeout(executor,milliseconds);
    &#125;

    @Override
    public int getNetworkTimeout() throws SQLException &#123;
        return connection.getNetworkTimeout();
    &#125;

    @Override
    public &lt;T&gt; T unwrap(Class&lt;T&gt; iface) throws SQLException &#123;
        return connection.unwrap(iface);
    &#125;

    @Override
    public boolean isWrapperFor(Class&lt;?&gt; iface) throws SQLException &#123;
        return connection.isWrapperFor(iface);
    &#125;
&#125;
</code></pre>
<h2 id="七、数据源管理-Context"><a href="#七、数据源管理-Context" class="headerlink" title="七、数据源管理 Context"></a>七、数据源管理 Context</h2><pre><code class="java">package com.example.util;

import lombok.extern.slf4j.Slf4j;

@Slf4j
public class DataSourceContext &#123;
    /**
     * 动态数据源名称上下文
     */
    private static final ThreadLocal&lt;String&gt; contextLocal = ThreadLocal.withInitial(() -&gt; &quot;one&quot;);

    /**
     * 设置数据源
     */
    public static void setDataSource(String key) &#123;
        contextLocal.set(key);
    &#125;

    /**
     * 获取数据源
     *
     * @return
     */
    public static String getDataSource() &#123;
        return contextLocal.get();
    &#125;

    /**
     * 重置/释放数据源
     */
    public static void clearDataSource() &#123;
        contextLocal.remove();
    &#125;
&#125;
</code></pre>
<h2 id="八、事务管理-Context"><a href="#八、事务管理-Context" class="headerlink" title="八、事务管理 Context"></a>八、事务管理 Context</h2><pre><code class="java">package com.example.util;

import com.example.config.CustomConnection;
import java.util.List;

public class TransactionContext &#123;
    // 默认事务处于关闭状态
    private static final ThreadLocal&lt;Boolean&gt; TRAN_SWITCH_CONTEXT = ThreadLocal.withInitial(() -&gt; false);
    /**
     * 多数据源 执行 事务期间用到的连接
     */
    public static final ThreadLocal&lt;List&lt;CustomConnection&gt;&gt; MULTI_TRAN_CONNECTION = new ThreadLocal&lt;&gt;();

    // 开启事务
    public static void openTran() &#123;
        TRAN_SWITCH_CONTEXT.set(true);
    &#125;
    // 关闭事务
    public static void closeTran() &#123;
        TRAN_SWITCH_CONTEXT.set(false);
    &#125;
    // 判断是否开启事务
    public static Boolean isOpenTran() &#123;
        return TRAN_SWITCH_CONTEXT.get();
    &#125;
&#125;
</code></pre>
<h2 id="九、写切面"><a href="#九、写切面" class="headerlink" title="九、写切面"></a>九、写切面</h2><p>利用 AOP 进行方法拦截，对使用了 多数据源 事务注解的方法，执行事务业务</p>
<pre><code class="java">package com.example.aspect;

import com.example.config.CustomConnection;
import com.example.util.TransactionContext;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;
import org.springframework.context.annotation.Configuration;

@Aspect
@Configuration
public class MultiDSTransactionConfig &#123;
    @Pointcut(&quot;@annotation(com.example.annotation.MultiDSTransaction)&quot;)
    public void transactPoint() &#123;
    &#125;

    @Around(&quot;transactPoint()&quot;)
    public Object multiTranAop(ProceedingJoinPoint joinPoint) throws Throwable &#123;
        // 开启事务
        TransactionContext.openTran();
        try &#123;
            // 执行业务
            Object proceed = joinPoint.proceed();
            // 提交事务 &amp; 关闭连接
            for (CustomConnection connection : TransactionContext.MULTI_TRAN_CONNECTION.get()) &#123;
                connection.commitMultiDbTran();
                connection.closeMultiDbTran();
            &#125;
            return proceed;
        &#125; catch (Throwable t) &#123;
            for (CustomConnection connection : TransactionContext.MULTI_TRAN_CONNECTION.get()) &#123;
                // 事务回滚
                connection.rollback();
                connection.closeMultiDbTran();
            &#125;
            throw t;
        &#125; finally &#123;
            // 清空 事务 连接，关闭当前事务
            TransactionContext.MULTI_TRAN_CONNECTION.get().clear();
            TransactionContext.closeTran();
        &#125;
    &#125;
&#125;
</code></pre>
<h2 id="十、测试类"><a href="#十、测试类" class="headerlink" title="十、测试类"></a>十、测试类</h2><p>测试代码如下，当报错的之后，事务同时回滚，数据没插入成功，当未出现报错，数据则都插入成功</p>
<pre><code class="java">package com.example.controller;

import com.example.annotation.MultiDSTransaction;
import com.example.util.DataSourceContext;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import javax.annotation.PostConstruct;
import java.util.stream.Stream;

@RestController
public class TestController &#123;
    @Autowired
    private JdbcTemplate jdbcTemplate;

    @RequestMapping(&quot;test&quot;)
    @MultiDSTransaction
    public void test() &#123;
        // 选择datasource1数据源
        DataSourceContext.setDataSource(&quot;one&quot;);
        int i = jdbcTemplate.update(&quot;INSERT INTO user (id, name, type) VALUES (1, &#39;meir&#39;, &#39;db_test_one&#39;)&quot;);

        // 模拟报错
        int k = 1 / 0;

        // 选择datasource2数据源
        DataSourceContext.setDataSource(&quot;two&quot;);
        int j = jdbcTemplate.update(&quot;INSERT INTO user (id, name, type) VALUES (1, &#39;sam&#39;, &#39;db_test_two&#39;)&quot;);

        System.out.println(&quot;over&quot;);
    &#125;

    @PostConstruct
    public void init1() &#123;
        Stream.of(&quot;one&quot;, &quot;two&quot;).forEach(i -&gt; initData(i));
    &#125;

    private void initData(String str) &#123;
        // 切换数据源
        DataSourceContext.setDataSource(str);
        // 初始化表和数据
        jdbcTemplate.execute(&quot;DROP TABLE IF EXISTS user&quot;);
        jdbcTemplate.execute(&quot;CREATE TABLE user (&quot;
                + &quot;id BIGINT NOT NULL,&quot;
                + &quot;name VARCHAR(50) DEFAULT NULL,&quot;
                + &quot;type VARCHAR(50) DEFAULT NULL,&quot;
                + &quot;PRIMARY KEY (id))&quot;);
        // 还原数据源
        DataSourceContext.clearDataSource();
    &#125;
&#125;
</code></pre>
<h1 id="SpringBoot-单机环境下静态多数据源的事务问题"><a href="#SpringBoot-单机环境下静态多数据源的事务问题" class="headerlink" title="SpringBoot 单机环境下静态多数据源的事务问题"></a>SpringBoot 单机环境下静态多数据源的事务问题</h1><h2 id="一、事务实现方案"><a href="#一、事务实现方案" class="headerlink" title="一、事务实现方案"></a>一、事务实现方案</h2><blockquote>
<p>Java解决单机环境下多数据源的事务问题：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/fantongxue/p/16867228.html">https://www.cnblogs.com/fantongxue/p/16867228.html</a></p>
</blockquote>
<p>利用 ThreadLocal 将事务方法 内用到的 connection 缓存起来，当业务执行完毕，再统一 commit 或者 rollback；</p>
<p>2、pom.xml 文件如下</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.5.0&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;multi-database-transaction-static&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;MultiDatabaseTransaction&lt;/name&gt;
    &lt;description&gt;MultiDatabaseTransaction&lt;/description&gt;
    &lt;properties&gt;
        &lt;java.version&gt;11&lt;/java.version&gt;
    &lt;/properties&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;!-- https://mvnrepository.com/artifact/com.h2database/h2 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.h2database&lt;/groupId&gt;
            &lt;artifactId&gt;h2&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;nexus-aliyun&lt;/id&gt;
            &lt;name&gt;nexus-aliyun&lt;/name&gt;
            &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;
            &lt;releases&gt;
                &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;/releases&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;

    &lt;pluginRepositories&gt;
        &lt;pluginRepository&gt;
            &lt;id&gt;public&lt;/id&gt;
            &lt;name&gt;aliyun nexus&lt;/name&gt;
            &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;
            &lt;releases&gt;
                &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;/releases&gt;
            &lt;snapshots&gt;
                &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;/snapshots&gt;
        &lt;/pluginRepository&gt;
    &lt;/pluginRepositories&gt;
&lt;/project&gt;
</code></pre>
<h2 id="二、自定义开启事务注解-1"><a href="#二、自定义开启事务注解-1" class="headerlink" title="二、自定义开启事务注解"></a>二、自定义开启事务注解</h2><pre><code class="java">package com.example.annotation;

import java.lang.annotation.*;

@Documented
@Retention(RetentionPolicy.RUNTIME)
@Target(&#123;ElementType.METHOD&#125;)
public @interface MultiDSTransaction &#123;
&#125;
</code></pre>
<h2 id="三、YML-配置多数据源-1"><a href="#三、YML-配置多数据源-1" class="headerlink" title="三、YML 配置多数据源"></a>三、YML 配置多数据源</h2><pre><code class="yaml">spring:
  datasource:
    datasource1:
      jdbc-url: jdbc:h2:mem:datasource1
      username: sa
      password: sa
      driverClassName: org.h2.Driver
    datasource2:
      jdbc-url: jdbc:h2:mem:datasource2
      username: sa
      password: sa
      driverClassName: org.h2.Driver
  h2:
    console:
      enabled: true
      path: /h2
      settings:
        web-allow-others: true
</code></pre>
<h2 id="四、多数据源配置类-1"><a href="#四、多数据源配置类-1" class="headerlink" title="四、多数据源配置类"></a>四、多数据源配置类</h2><p>使用了 @Primary 注解后，作用是将该bean设置为主要注入bean，当注入相同类型的datasource的bean时就不会注入DataSourceConfig配置类中注入的两个bean了，只会注入这个，mybatis 在使用 DataSourceUtil.getDataSource 的时候获取的是这个自定义数据源，执行的是此自定义数据源的 getConnection 方法。jdbcTemplate、JPA 也是同理。</p>
<pre><code class="java">package com.example.config;

import com.example.util.DataSourceContext;
import com.example.util.TransactionContext;
import org.springframework.beans.factory.InitializingBean;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Primary;
import org.springframework.stereotype.Component;

import javax.sql.DataSource;
import java.io.PrintWriter;
import java.sql.Connection;
import java.sql.SQLException;
import java.sql.SQLFeatureNotSupportedException;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.logging.Logger;

/**
 * 管理多个数据源
 */
public class StaticDataSource implements DataSource &#123;

    private Map&lt;String, DataSource&gt; dataSourceMap;

    public StaticDataSource(Map&lt;String, DataSource&gt; dataSourceMap) &#123;
        this.dataSourceMap = dataSourceMap;
    &#125;

    @Override
    public Connection getConnection() throws SQLException &#123;
        Connection connection = dataSourceMap.get(DataSourceContext.getDataSource()).getConnection();
        CustomConnection customConnection = new CustomConnection(connection);
        if (TransactionContext.isOpenTran()) &#123;
            customConnection.setAutoCommit(false);
            List&lt;CustomConnection&gt; customConnections = TransactionContext.MULTI_TRAN_CONNECTION.get();
            if (customConnections == null) &#123;
                customConnections = new ArrayList&lt;&gt;();
            &#125;
            customConnections.add(customConnection);
            TransactionContext.MULTI_TRAN_CONNECTION.set(customConnections);
        &#125;
        return customConnection;
    &#125;

    @Override
    public Connection getConnection(String username, String password) throws SQLException &#123;
        return null;
    &#125;

    @Override
    public &lt;T&gt; T unwrap(Class&lt;T&gt; iface) throws SQLException &#123;
        return null;
    &#125;

    @Override
    public boolean isWrapperFor(Class&lt;?&gt; iface) throws SQLException &#123;
        return false;
    &#125;

    @Override
    public PrintWriter getLogWriter() throws SQLException &#123;
        return null;
    &#125;

    @Override
    public void setLogWriter(PrintWriter out) throws SQLException &#123;

    &#125;

    @Override
    public void setLoginTimeout(int seconds) throws SQLException &#123;

    &#125;

    @Override
    public int getLoginTimeout() throws SQLException &#123;
        return 0;
    &#125;

    @Override
    public Logger getParentLogger() throws SQLFeatureNotSupportedException &#123;
        return null;
    &#125;
&#125;
</code></pre>
<h2 id="五、自定义数据源-1"><a href="#五、自定义数据源-1" class="headerlink" title="五、自定义数据源"></a>五、自定义数据源</h2><p>在自定义数据源中注入上边那两个多数据源，维持多数据源执行事务期间用到的连接列表，在自定义数据源中添加事务相关业务，既在获取 连接的地方将 Connection 缓存到 ThreadLocal 中</p>
<pre><code class="java">package com.example.config;

import com.example.util.DataSourceContext;
import com.example.util.TransactionContext;
import org.springframework.beans.factory.InitializingBean;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Primary;
import org.springframework.stereotype.Component;
import javax.sql.DataSource;
import java.io.PrintWriter;
import java.sql.Connection;
import java.sql.SQLException;
import java.sql.SQLFeatureNotSupportedException;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.logging.Logger;

/**
 * 管理多个数据源
 */
public class StaticDataSource implements DataSource &#123;

    private Map&lt;String, DataSource&gt; dataSourceMap;

    public StaticDataSource(Map&lt;String, DataSource&gt; dataSourceMap) &#123;
        this.dataSourceMap = dataSourceMap;
    &#125;

    @Override
    public Connection getConnection() throws SQLException &#123;
        Connection connection = dataSourceMap.get(DataSourceContext.getDataSource()).getConnection();
        CustomConnection customConnection = new CustomConnection(connection);
        if (TransactionContext.isOpenTran()) &#123;
            customConnection.setAutoCommit(false);
            List&lt;CustomConnection&gt; customConnections = TransactionContext.MULTI_TRAN_CONNECTION.get();
            if (customConnections == null) &#123;
                customConnections = new ArrayList&lt;&gt;();
            &#125;
            customConnections.add(customConnection);
            TransactionContext.MULTI_TRAN_CONNECTION.set(customConnections);
        &#125;
        return customConnection;
    &#125;

    @Override
    public Connection getConnection(String username, String password) throws SQLException &#123;
        return null;
    &#125;

    @Override
    public &lt;T&gt; T unwrap(Class&lt;T&gt; iface) throws SQLException &#123;
        return null;
    &#125;

    @Override
    public boolean isWrapperFor(Class&lt;?&gt; iface) throws SQLException &#123;
        return false;
    &#125;

    @Override
    public PrintWriter getLogWriter() throws SQLException &#123;
        return null;
    &#125;

    @Override
    public void setLogWriter(PrintWriter out) throws SQLException &#123;

    &#125;

    @Override
    public void setLoginTimeout(int seconds) throws SQLException &#123;

    &#125;

    @Override
    public int getLoginTimeout() throws SQLException &#123;
        return 0;
    &#125;

    @Override
    public Logger getParentLogger() throws SQLFeatureNotSupportedException &#123;
        return null;
    &#125;
&#125;
</code></pre>
<h2 id="六、重写-Connection-连接-1"><a href="#六、重写-Connection-连接-1" class="headerlink" title="六、重写 Connection 连接"></a>六、重写 Connection 连接</h2><pre><code class="java">package com.example.config;

import com.example.util.TransactionContext;
import java.sql.*;
import java.util.Map;
import java.util.Properties;
import java.util.concurrent.Executor;

public class CustomConnection implements Connection &#123;
    // 真实的连接
    private Connection connection;

    public CustomConnection(Connection connection) &#123;
        this.connection = connection;
    &#125;
    @Override
    public void commit() throws SQLException &#123;
        // 如果没开启多数据源事务，则走 commit
        if (!TransactionContext.isOpenTran()) &#123;
            connection.commit();
        &#125;
    &#125;

    @Override
    public void rollback() throws SQLException &#123;
        connection.rollback();
    &#125;

    public void commitMultiDbTran() throws SQLException &#123;
        // 如果开启多数据源，则走 这里的 commit
        connection.commit();
    &#125;
    @Override
    public void close() throws SQLException &#123;
        // mybatis 执行完业务后，会触发 close() 操作，如果 connection 被提前 close 了，业务就会出错
        if (!TransactionContext.isOpenTran()) &#123;
            connection.close();
        &#125;
    &#125;
    public void closeMultiDbTran() throws SQLException &#123;
        // 如果开启多数据源事务，则走 这里的 close
        connection.close();
    &#125;

    @Override
    public Statement createStatement() throws SQLException &#123;
        return connection.createStatement();
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql) throws SQLException &#123;
        return connection.prepareStatement(sql);
    &#125;

    @Override
    public CallableStatement prepareCall(String sql) throws SQLException &#123;
        return connection.prepareCall(sql);
    &#125;

    @Override
    public String nativeSQL(String sql) throws SQLException &#123;
        return connection.nativeSQL(sql);
    &#125;

    @Override
    public void setAutoCommit(boolean autoCommit) throws SQLException &#123;
        connection.setAutoCommit(autoCommit);
    &#125;

    @Override
    public boolean getAutoCommit() throws SQLException &#123;
        return connection.getAutoCommit();
    &#125;

    @Override
    public boolean isClosed() throws SQLException &#123;
        return connection.isClosed();
    &#125;

    @Override
    public DatabaseMetaData getMetaData() throws SQLException &#123;
        return connection.getMetaData();
    &#125;

    @Override
    public void setReadOnly(boolean readOnly) throws SQLException &#123;
        connection.setReadOnly(readOnly);
    &#125;

    @Override
    public boolean isReadOnly() throws SQLException &#123;
        return connection.isReadOnly();
    &#125;

    @Override
    public void setCatalog(String catalog) throws SQLException &#123;
        connection.setCatalog(catalog);
    &#125;

    @Override
    public String getCatalog() throws SQLException &#123;
        return connection.getCatalog();
    &#125;

    @Override
    public void setTransactionIsolation(int level) throws SQLException &#123;
        connection.setTransactionIsolation(level);
    &#125;

    @Override
    public int getTransactionIsolation() throws SQLException &#123;
        return connection.getTransactionIsolation();
    &#125;

    @Override
    public SQLWarning getWarnings() throws SQLException &#123;
        return connection.getWarnings();
    &#125;

    @Override
    public void clearWarnings() throws SQLException &#123;
        connection.clearWarnings();
    &#125;

    @Override
    public Statement createStatement(int resultSetType, int resultSetConcurrency) throws SQLException &#123;
        return connection.createStatement(resultSetType,resultSetConcurrency);
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql, int resultSetType, int resultSetConcurrency) throws SQLException &#123;
        return connection.prepareStatement(sql,resultSetType,resultSetConcurrency);
    &#125;

    @Override
    public CallableStatement prepareCall(String sql, int resultSetType, int resultSetConcurrency) throws SQLException &#123;
        return connection.prepareCall(sql,resultSetType,resultSetConcurrency);
    &#125;

    @Override
    public Map&lt;String, Class&lt;?&gt;&gt; getTypeMap() throws SQLException &#123;
        return connection.getTypeMap();
    &#125;

    @Override
    public void setTypeMap(Map&lt;String, Class&lt;?&gt;&gt; map) throws SQLException &#123;
        connection.setTypeMap(map);
    &#125;

    @Override
    public void setHoldability(int holdability) throws SQLException &#123;
        connection.setHoldability(holdability);
    &#125;

    @Override
    public int getHoldability() throws SQLException &#123;
        return connection.getHoldability();
    &#125;

    @Override
    public Savepoint setSavepoint() throws SQLException &#123;
        return connection.setSavepoint();
    &#125;

    @Override
    public Savepoint setSavepoint(String name) throws SQLException &#123;
        return connection.setSavepoint(name);
    &#125;

    @Override
    public void rollback(Savepoint savepoint) throws SQLException &#123;
        connection.rollback(savepoint);
    &#125;

    @Override
    public void releaseSavepoint(Savepoint savepoint) throws SQLException &#123;
        connection.releaseSavepoint(savepoint);
    &#125;

    @Override
    public Statement createStatement(int resultSetType, int resultSetConcurrency, int resultSetHoldability) throws SQLException &#123;
        return connection.createStatement(resultSetType,resultSetConcurrency,resultSetHoldability);
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql, int resultSetType, int resultSetConcurrency, int resultSetHoldability) throws SQLException &#123;
        return connection.prepareStatement(sql,resultSetType,resultSetConcurrency,resultSetHoldability);
    &#125;

    @Override
    public CallableStatement prepareCall(String sql, int resultSetType, int resultSetConcurrency, int resultSetHoldability) throws SQLException &#123;
        return connection.prepareCall(sql,resultSetType,resultSetConcurrency,resultSetHoldability);
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql, int autoGeneratedKeys) throws SQLException &#123;
        return connection.prepareStatement(sql,autoGeneratedKeys);
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql, int[] columnIndexes) throws SQLException &#123;
        return connection.prepareStatement(sql,columnIndexes);
    &#125;

    @Override
    public PreparedStatement prepareStatement(String sql, String[] columnNames) throws SQLException &#123;
        return connection.prepareStatement(sql,columnNames);
    &#125;

    @Override
    public Clob createClob() throws SQLException &#123;
        return connection.createClob();
    &#125;

    @Override
    public Blob createBlob() throws SQLException &#123;
        return connection.createBlob();
    &#125;

    @Override
    public NClob createNClob() throws SQLException &#123;
        return connection.createNClob();
    &#125;

    @Override
    public SQLXML createSQLXML() throws SQLException &#123;
        return connection.createSQLXML();
    &#125;

    @Override
    public boolean isValid(int timeout) throws SQLException &#123;
        return connection.isValid(timeout);
    &#125;

    @Override
    public void setClientInfo(String name, String value) throws SQLClientInfoException &#123;
        connection.setClientInfo(name,value);
    &#125;

    @Override
    public void setClientInfo(Properties properties) throws SQLClientInfoException &#123;
        connection.setClientInfo(properties);
    &#125;

    @Override
    public String getClientInfo(String name) throws SQLException &#123;
        return connection.getClientInfo(name);
    &#125;

    @Override
    public Properties getClientInfo() throws SQLException &#123;
        return connection.getClientInfo();
    &#125;

    @Override
    public Array createArrayOf(String typeName, Object[] elements) throws SQLException &#123;
        return connection.createArrayOf(typeName,elements);
    &#125;

    @Override
    public Struct createStruct(String typeName, Object[] attributes) throws SQLException &#123;
        return connection.createStruct(typeName,attributes);
    &#125;

    @Override
    public void setSchema(String schema) throws SQLException &#123;
        connection.setSchema(schema);
    &#125;

    @Override
    public String getSchema() throws SQLException &#123;
        return connection.getSchema();
    &#125;

    @Override
    public void abort(Executor executor) throws SQLException &#123;
        connection.abort(executor);
    &#125;

    @Override
    public void setNetworkTimeout(Executor executor, int milliseconds) throws SQLException &#123;
        connection.setNetworkTimeout(executor,milliseconds);
    &#125;

    @Override
    public int getNetworkTimeout() throws SQLException &#123;
        return connection.getNetworkTimeout();
    &#125;

    @Override
    public &lt;T&gt; T unwrap(Class&lt;T&gt; iface) throws SQLException &#123;
        return connection.unwrap(iface);
    &#125;

    @Override
    public boolean isWrapperFor(Class&lt;?&gt; iface) throws SQLException &#123;
        return connection.isWrapperFor(iface);
    &#125;
&#125;
</code></pre>
<h2 id="七、数据源管理-Context-1"><a href="#七、数据源管理-Context-1" class="headerlink" title="七、数据源管理 Context"></a>七、数据源管理 Context</h2><pre><code class="java">package com.example.util;

import lombok.extern.slf4j.Slf4j;

@Slf4j
public class DataSourceContext &#123;
    /**
     * 动态数据源名称上下文
     */
    private static final ThreadLocal&lt;String&gt; contextLocal = ThreadLocal.withInitial(() -&gt; &quot;one&quot;);

    /**
     * 设置数据源
     */
    public static void setDataSource(String key) &#123;
        contextLocal.set(key);
    &#125;

    /**
     * 获取数据源
     *
     * @return
     */
    public static String getDataSource() &#123;
        return contextLocal.get();
    &#125;

    /**
     * 重置/释放数据源
     */
    public static void clearDataSource() &#123;
        contextLocal.remove();
    &#125;
&#125;
</code></pre>
<h2 id="八、事务管理-Context-1"><a href="#八、事务管理-Context-1" class="headerlink" title="八、事务管理 Context"></a>八、事务管理 Context</h2><pre><code class="java">package com.example.util;

import com.example.config.CustomConnection;
import java.util.List;

public class TransactionContext &#123;
    // 默认事务处于关闭状态
    private static final ThreadLocal&lt;Boolean&gt; TRAN_SWITCH_CONTEXT = ThreadLocal.withInitial(() -&gt; false);
    /**
     * 多数据源 执行 事务期间用到的连接
     */
    public static final ThreadLocal&lt;List&lt;CustomConnection&gt;&gt; MULTI_TRAN_CONNECTION = new ThreadLocal&lt;&gt;();

    // 开启事务
    public static void openTran() &#123;
        TRAN_SWITCH_CONTEXT.set(true);
    &#125;
    // 关闭事务
    public static void closeTran() &#123;
        TRAN_SWITCH_CONTEXT.set(false);
    &#125;
    // 判断是否开启事务
    public static Boolean isOpenTran() &#123;
        return TRAN_SWITCH_CONTEXT.get();
    &#125;
&#125;
</code></pre>
<h2 id="九、写切面-1"><a href="#九、写切面-1" class="headerlink" title="九、写切面"></a>九、写切面</h2><p>利用 AOP 进行方法拦截，对使用了 多数据源 事务注解的方法，执行事务业务</p>
<pre><code class="java">package com.example.aspect;

import com.example.config.CustomConnection;
import com.example.util.TransactionContext;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;
import org.springframework.context.annotation.Configuration;

@Aspect
@Configuration
public class MultiDSTransactionConfig &#123;
    @Pointcut(&quot;@annotation(com.example.annotation.MultiDSTransaction)&quot;)
    public void transactPoint() &#123;
    &#125;

    @Around(&quot;transactPoint()&quot;)
    public Object multiTranAop(ProceedingJoinPoint joinPoint) throws Throwable &#123;
        // 开启事务
        TransactionContext.openTran();
        try &#123;
            // 执行业务
            Object proceed = joinPoint.proceed();
            // 提交事务 &amp; 关闭连接
            for (CustomConnection connection : TransactionContext.MULTI_TRAN_CONNECTION.get()) &#123;
                connection.commitMultiDbTran();
                connection.closeMultiDbTran();
            &#125;
            return proceed;
        &#125; catch (Throwable t) &#123;
            for (CustomConnection connection : TransactionContext.MULTI_TRAN_CONNECTION.get()) &#123;
                // 事务回滚
                connection.rollback();
                connection.closeMultiDbTran();
            &#125;
            throw t;
        &#125; finally &#123;
            // 清空 事务 连接，关闭当前事务
            TransactionContext.MULTI_TRAN_CONNECTION.get().clear();
            TransactionContext.closeTran();
        &#125;
    &#125;
&#125;
</code></pre>
<h2 id="十、测试类-1"><a href="#十、测试类-1" class="headerlink" title="十、测试类"></a>十、测试类</h2><p>测试代码如下，当报错的之后，事务同时回滚，数据没插入成功，当未出现报错，数据则都插入成功</p>
<pre><code class="java">package com.example.controller;

import com.example.annotation.MultiDSTransaction;
import com.example.util.DataSourceContext;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import javax.annotation.PostConstruct;
import java.util.stream.Stream;

@RestController
public class TestController &#123;
    @Autowired
    private JdbcTemplate jdbcTemplate;

    @RequestMapping(&quot;test&quot;)
    @MultiDSTransaction
    public void test() &#123;
        // 选择datasource1数据源
        DataSourceContext.setDataSource(&quot;one&quot;);
        int i = jdbcTemplate.update(&quot;INSERT INTO user (id, name, type) VALUES (1, &#39;meir&#39;, &#39;db_test_one&#39;)&quot;);

        // 模拟报错
        int k = 1 / 0;

        // 选择datasource2数据源
        DataSourceContext.setDataSource(&quot;two&quot;);
        int j = jdbcTemplate.update(&quot;INSERT INTO user (id, name, type) VALUES (1, &#39;sam&#39;, &#39;db_test_two&#39;)&quot;);

        System.out.println(&quot;over&quot;);
    &#125;

    @PostConstruct
    public void init1() &#123;
        Stream.of(&quot;one&quot;, &quot;two&quot;).forEach(i -&gt; initData(i));
    &#125;

    private void initData(String str) &#123;
        // 切换数据源
        DataSourceContext.setDataSource(str);
        // 初始化表和数据
        jdbcTemplate.execute(&quot;DROP TABLE IF EXISTS user&quot;);
        jdbcTemplate.execute(&quot;CREATE TABLE user (&quot;
                + &quot;id BIGINT NOT NULL,&quot;
                + &quot;name VARCHAR(50) DEFAULT NULL,&quot;
                + &quot;type VARCHAR(50) DEFAULT NULL,&quot;
                + &quot;PRIMARY KEY (id))&quot;);
        // 还原数据源
        DataSourceContext.clearDataSource();
    &#125;
&#125;
</code></pre>
<h1 id="SpringBoot-JTA-Atomikos-多数据源的分布式事务管理详解"><a href="#SpringBoot-JTA-Atomikos-多数据源的分布式事务管理详解" class="headerlink" title="SpringBoot JTA Atomikos 多数据源的分布式事务管理详解"></a>SpringBoot JTA Atomikos 多数据源的分布式事务管理详解</h1><h2 id="1、分布式事务介绍"><a href="#1、分布式事务介绍" class="headerlink" title="1、分布式事务介绍"></a>1、分布式事务介绍</h2><p>Atomikos 是一个易用、可靠、开放源码的事务管理器，它可以用于管理分布式事务，尤其在微服务架构中非常实用。它支持 JTA（Java Transaction API）规范，能够与各种 JTA 兼容的资源管理器（如数据库和消息队列）配合使用。</p>
<p>分布式事务：当一个业务操作需要修改多个资源（如多个数据库或消息队列）时，我们需要保证这些修改操作的原子性，即它们要么全部成功，要么全部失败。这就是分布式事务。</p>
<p>JTA：Java Transaction API（JTA）是Java平台的一个事务规范，定义了用户和事务管理器以及事务管理器和资源管理器之间的接口。Atomikos 作为一个事务管理器，就是遵循 JTA 规范的。</p>
<p>XA 协议：XA 协议是分布式事务的一个重要协议，它定义了全局事务 ID、分支事务 ID 等概念，以及如何协调分支事务的接口。Atomikos 支持 XA 协议。</p>
<p>Atomikos 还提供了自动恢复、故障转移等高级特性，以进一步提高分布式事务的可靠性。主要用于处理跨数据库事务；在 SpringBoot 的文档也推荐更多人使用 Atomikos。</p>
<h2 id="2、Atomikos-参考文档"><a href="#2、Atomikos-参考文档" class="headerlink" title="2、Atomikos 参考文档"></a>2、Atomikos 参考文档</h2><p>SpringBoot 提供了一个用于整合 Atomikos 的 starter，名为 <strong>spring-boot-starter-jta-atomikos</strong>。它是 SpringBoot 提供的一系列 “starter” 依赖之一。</p>
<p>在 SpringBoot 2.x 中，整合了这两个 JTA 的实现：</p>
<ul>
<li>Atomikos：可以通过引入spring-boot-starter-jta-atomikos依赖来使用</li>
<li>Bitronix：可以通过引入spring-boot-starter-jta-bitronix依赖来使用</li>
</ul>
<p>由于 Bitronix 自 SpringBoot 2.3.0 开始不推荐使用，所以在下面的动手环节中，我们将使用 Atomikos 作为例子来介绍JTA的使用。</p>
<p>SpringBoot 官方文档的 “Spring Boot Features” 部分有一个 “Working with JTA” 的小节，其中提到了如何使用 spring-boot-starter-jta-atomikos。</p>
<ul>
<li>链接：<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.7.18/reference/htmlsingle/#boot-features-jta">https://docs.spring.io/spring-boot/docs/2.7.18/reference/htmlsingle/#boot-features-jta</a></li>
</ul>
<h2 id="3、Atomikos-组件介绍"><a href="#3、Atomikos-组件介绍" class="headerlink" title="3、Atomikos 组件介绍"></a>3、Atomikos 组件介绍</h2><p>Atomikos 是一个提供分布式事务管理的开源事务管理器。将它们结合使用，可以在 Spring Boot 应用程序中实现分布式事务的管理。</p>
<p>在 SpringBoot 中使用 Atomikos，通常需要进行以下步骤：</p>
<ol>
<li>引入 Atomikos 依赖：首先，在 Maven 或 Gradle 构建文件中添加 Atomikos 的依赖项。可以添加 atomikos-transactions-spring-boot-starter 依赖，它是 Atomikos 与 SpringBoot 集成的起点。</li>
<li>配置数据源：在 SpringBoot 应用程序中，你需要配置多个数据源。可以使用 Spring Boot 的自动配置功能，根据配置文件或属性来配置数据源。你可以使用任何支持 Atomikos 的数据源，如 Atomikos 提供的 AtomikosDataSourceBean 或其他第三方数据源。</li>
<li>配置 Atomikos 事务管理器：在 SpringBoot 应用程序中，你需要配置 Atomikos 事务管理器。可以通过在配置类中创建 JtaTransactionManager 实例，并将其与 Atomikos 的 UserTransactionManager 和 TransactionManager 关联起来。这样，Spring 将使用 Atomikos 事务管理器来管理分布式事务。</li>
<li>配置 JTA 事务管理器：为了使 SpringBoot 应用程序能够使用 Atomikos 进行分布式事务管理，你需要配置 JTA 事务管理器。可以使用 Spring Boot 的自动配置功能，根据配置文件或属性来配置 JTA 事务管理器。</li>
<li>在方法上添加 @Transactional 注解：在需要进行事务管理的方法上，添加 Spring 的 @Transactional 注解。这将告诉 Spring 在方法执行期间启动和提交事务，并回滚事务（如果发生异常）。</li>
</ol>
<p>使用 SpringBoot + Atomikos 的原理如下：</p>
<ul>
<li><p>SpringBoot 提供了自动配置功能，可以根据配置文件或属性来自动配置数据源和事务管理器。</p>
</li>
<li><p>Atomikos 是一个独立的事务管理器，它提供了 JTA（Java Transaction API）的实现，可以处理分布式事务。</p>
</li>
<li><p>在 Spring Boot 中，你配置了多个数据源，并使用 Atomikos 的数据源实现（如 AtomikosDataSourceBean）来实现分布式事务。</p>
</li>
<li><p>当你在方法上添加了 @Transactional 注解时，Spring Boot 会使用 Atomikos 的事务管理器来管理事务。</p>
</li>
<li><p>当方法执行时，事务管理器会协调各个数据源的事务，并在方法执行完成后根据事务的状态来提交或回滚事务。</p>
</li>
</ul>
<p>总结来说，SpringBoot + Atomikos 的原理是利用 SpringBoot 的自动配置功能来配置多个数据源和事务管理器，并使用 Atomikos 的事务管理器实现分布式事务的管理。这样，你可以在 SpringBoot 应用程序中使用 @Transactional 注解来管理分布式事务。</p>
<p>最后需要确保你的数据库支持 XA 事务，否则无法使用 Atomikos。</p>
<h2 id="4、JTA-AbstractRoutingDataSource-数据源切换失效"><a href="#4、JTA-AbstractRoutingDataSource-数据源切换失效" class="headerlink" title="4、JTA + AbstractRoutingDataSource 数据源切换失效"></a>4、JTA + AbstractRoutingDataSource 数据源切换失效</h2><p>在使用 JTA、<code>AbstractRoutingDataSource</code> 和声明式事务时，数据源切换失效的问题通常与以下几个方面有关：</p>
<h3 id="1、事务上下文的绑定"><a href="#1、事务上下文的绑定" class="headerlink" title="1、事务上下文的绑定"></a>1、事务上下文的绑定</h3><ul>
<li>当声明式事务（通过 <code>@Transactional</code> 注解）启动时，事务管理器会创建一个新的事务上下文，并根据路由策略选择并绑定一个具体的数据源。这个绑定一旦完成，整个事务周期内都将使用这个数据源，即使 <code>AbstractRoutingDataSource</code> 后续的路由策略改变，也不会影响已绑定的数据源。</li>
<li>因为 JTA 事务管理器管理的是全局事务，所有参与的资源（即数据源）在事务启动时都必须确定。一旦事务上下文绑定到某个数据源，事务的整个生命周期内都将固定使用这个数据源，导致数据源切换失效。</li>
</ul>
<h3 id="2、JTA-全局事务的特性"><a href="#2、JTA-全局事务的特性" class="headerlink" title="2、JTA 全局事务的特性"></a>2、JTA 全局事务的特性</h3><ul>
<li>JTA（Java Transaction API）负责管理分布式事务。它需要在事务启动时，将所有参与的资源（如不同的数据源）提前注册到事务中。由于 JTA 的全局事务特性，切换数据源必须在事务启动前完成。事务启动后，无法再改变绑定到事务上的资源。</li>
<li>如果 <code>AbstractRoutingDataSource</code> 尝试在事务进行中切换数据源，新的数据源可能不会被 JTA 事务管理器识别或注册，从而导致事务管理失效，数据源切换无效。</li>
</ul>
<h3 id="3、声明式事务与路由策略的冲突"><a href="#3、声明式事务与路由策略的冲突" class="headerlink" title="3、声明式事务与路由策略的冲突"></a>3、声明式事务与路由策略的冲突</h3><ul>
<li>声明式事务依赖于 Spring 的 <code>PlatformTransactionManager</code> 或 JTA 事务管理器来管理事务。事务管理器会在事务开始时根据路由策略选择一个数据源，并在事务执行期间固定使用该数据源。</li>
<li><code>AbstractRoutingDataSource</code> 的路由策略通常基于当前线程的上下文信息（如请求的某些参数）动态选择数据源。如果在事务开始后路由策略改变，由于事务已经绑定到某个数据源，路由切换将无效。</li>
</ul>
<h3 id="4、解决方案"><a href="#4、解决方案" class="headerlink" title="4、解决方案"></a>4、解决方案</h3><ol>
<li><p>在事务外部切换数据源</p>
<ul>
<li>如果可能，确保数据源的选择在事务开始前完成。你可以在业务逻辑中提前设置好路由策略，确保在事务启动时，<code>AbstractRoutingDataSource</code> 能正确选择并绑定数据源。</li>
<li>将数据源的切换逻辑放在不使用事务管理的代码部分，这样可以避免因事务绑定导致的数据源切换问题。</li>
</ul>
</li>
<li><p>手动管理事务</p>
<ul>
<li>对于复杂的事务场景，可以考虑手动管理事务而不是依赖声明式事务。这允许你更精确地控制事务的启动和结束时机，确保在事务启动前完成数据源切换。</li>
<li>可以使用 <code>TransactionTemplate</code> 或者直接使用 <code>JtaTransactionManager</code> 进行手动事务管理。</li>
</ul>
</li>
<li><p>使用独立的事务管理器</p>
<ul>
<li>考虑为每个数据源配置独立的事务管理器，而不是使用全局的 JTA 事务管理器。每个数据源使用自己的事务管理器，这样可以避免 JTA 全局事务的限制。</li>
<li>这种方式更适合没有严格分布式事务需求的场景。</li>
</ul>
</li>
<li><p>使用 Seata 等分布式事务框架</p>
<ul>
<li>如果你确实需要在分布式系统中进行数据源切换和事务管理，可以考虑使用像 Seata 这样的分布式事务框架，它支持在微服务环境下的分布式事务，并且能够处理跨数据源的事务。</li>
</ul>
</li>
</ol>
<h3 id="5、最终总结"><a href="#5、最终总结" class="headerlink" title="5、最终总结"></a>5、最终总结</h3><p>在使用 JTA、AbstractRoutingDataSource 和声明式事务时，数据源切换失效通常是由于事务上下文绑定和 JTA 全局事务的限制所导致的。通过在事务外部进行数据源切换、手动管理事务或者使用独立的事务管理器，可以有效地避免这个问题。确保事务的管理和数据源的选择策略保持一致，是解决该问题的关键。</p>
<p>所以下面咱们的案例都是静态多数据源整合 jta-atomikos 实现多数据源分布式事务。</p>
<h1 id="SpringBoot-使用-JdbcTemplate-Atomikos-实现分布式事务"><a href="#SpringBoot-使用-JdbcTemplate-Atomikos-实现分布式事务" class="headerlink" title="SpringBoot 使用 JdbcTemplate + Atomikos 实现分布式事务"></a>SpringBoot 使用 JdbcTemplate + Atomikos 实现分布式事务</h1><h2 id="1、添加依赖"><a href="#1、添加依赖" class="headerlink" title="1、添加依赖"></a>1、添加依赖</h2><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.7.18&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;h2-jdbctemplate-multi-transaction&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;h2-jdbctemplate-multi-transaction&lt;/name&gt;
    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;
    &lt;properties&gt;
        &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;
    &lt;/properties&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-jta-atomikos&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-jdbc&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;!-- https://mvnrepository.com/artifact/com.h2database/h2 --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.h2database&lt;/groupId&gt;
            &lt;artifactId&gt;h2&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;
</code></pre>
<h2 id="2、在-application-yml-中配置多个数据源"><a href="#2、在-application-yml-中配置多个数据源" class="headerlink" title="2、在 application.yml 中配置多个数据源"></a>2、在 application.yml 中配置多个数据源</h2><pre><code class="yaml">server:
  port: 8090

#################### H2 数据库配置 ####################
# 文件数据库, jdbc:h2:file:./dbh2/dbc2m;AUTO_SERVER=TRUE
# 内存数据库，jdbc:h2:mem:master
spring:
  datasource1:
    unique-resource-name: datasource1
    xa-data-source-class-name: org.h2.jdbcx.JdbcDataSource
    xa-properties:
      url: jdbc:h2:mem:master
      user: sa
      password: sa
    exclusive-connection-mode: true
    min-pool-size: 3
    max-pool-size: 10
    max-lifetime: 20000
    borrow-connection-timeout: 10000
    test-query: SELECT 1 from dual # 由于采用HikariCP，用于检测数据库连接是否存活。
  datasource2:
    unique-resource-name: datasource2
    xa-data-source-class-name: org.h2.jdbcx.JdbcDataSource
    xa-properties:
      url: jdbc:h2:mem:slave
      user: sa
      password: sa
    exclusive-connection-mode: true
    min-pool-size: 3
    max-pool-size: 10
    max-lifetime: 20000
    borrow-connection-timeout: 10000
    test-query: SELECT 1 from dual # 由于采用HikariCP，用于检测数据库连接是否存活。

  #################### H2 Web Console设置 ####################
  ### enabled：程序开启时就会启动 H2 Web Console, 默认就是启动的
  ### path：配置访问地址为：/h2，访问 H2 Web Console，默认:/h2-console
  ### settings.web-allow-others：开启H2 Web Console远程访问，默认为false不开启只能在本机访问
  h2:
    console:
      enabled: true
      path: /h2
      settings:
        web-allow-others: true

## SQL打印以及事务的打印
logging:
  level:
    org.springframework.transaction: DEBUG
    org.springframework.jdbc.datasource.DataSourceTransactionManager: DEBUG
    org.springframework.jdbc.core.JdbcTemplate: DEBUG
    org.springframework.jdbc.datasource.DataSourceUtils: DEBUG
    org.springframework.jdbc.core.StatementCreatorUtils: TRACE
</code></pre>
<h2 id="3、第一个数据源配置"><a href="#3、第一个数据源配置" class="headerlink" title="3、第一个数据源配置"></a>3、第一个数据源配置</h2><pre><code class="java">package com.example.config;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jta.atomikos.AtomikosDataSourceBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.context.annotation.Primary;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.datasource.DataSourceTransactionManager;
import org.springframework.transaction.PlatformTransactionManager;

import javax.sql.DataSource;

/**
 * &#39;@EnableAutoConfiguration&#39; 就是去掉springboot默认自动配置数据源
 */
@DependsOn(&quot;transactionManager&quot;)
@Configuration
@EnableAutoConfiguration(exclude = &#123;DataSourceAutoConfiguration.class&#125;)
public class JdbcTemplateDataSource1Config &#123;

    @Primary
    @Bean
    @ConfigurationProperties(prefix = &quot;spring.datasource1&quot;)
    public DataSource datasource1() &#123;
        // 这里是关键，返回的是AtomikosDataSourceBean，所有的配置属性也都是注入到这个类里面
        return new AtomikosDataSourceBean();
    &#125;

    /**
     * 初始化JdbcTemplate，这里必须显示配置。
     */
    @Bean
    public JdbcTemplate jdbcTemplate1(@Qualifier(&quot;datasource1&quot;) DataSource datasource1) &#123;
        return new JdbcTemplate(datasource1);
    &#125;

    /**
     * 事务管理
     */
    @Bean(name = &quot;transactionManager1&quot;)
    public PlatformTransactionManager transactionManager1(@Qualifier(&quot;datasource1&quot;) DataSource datasource1) &#123;
        return new DataSourceTransactionManager(datasource1);
    &#125;
&#125;
</code></pre>
<ul>
<li>这里需要注意：数据源需要在 JTA transactionManager 创建后创建。</li>
</ul>
<h2 id="4、第二个数据源配置"><a href="#4、第二个数据源配置" class="headerlink" title="4、第二个数据源配置"></a>4、第二个数据源配置</h2><pre><code class="java">package com.example.config;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jta.atomikos.AtomikosDataSourceBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.datasource.DataSourceTransactionManager;
import org.springframework.transaction.PlatformTransactionManager;
import javax.sql.DataSource;

@DependsOn(&quot;transactionManager&quot;)
@Configuration
public class JdbcTemplateDataSource2Config &#123;

    @Bean
    @ConfigurationProperties(prefix = &quot;spring.datasource2&quot;)
    public DataSource datasource2() &#123;
        return new AtomikosDataSourceBean();
    &#125;

    /**
     * 初始化JdbcTemplate，这里必须显示配置。
     */
    @Bean
    public JdbcTemplate jdbcTemplate2(@Qualifier(&quot;datasource2&quot;) DataSource datasource2) &#123;
        return new JdbcTemplate(datasource2);
    &#125;

    /**
     * 事务管理
     */
    @Bean(name = &quot;transactionManager2&quot;)
    public PlatformTransactionManager transactionManager2(@Qualifier(&quot;datasource2&quot;) DataSource datasource2) &#123;
        return new DataSourceTransactionManager(datasource2);
    &#125;

&#125;
</code></pre>
<ul>
<li>这里需要注意：数据源需要在 JTA transactionManager 创建后创建。</li>
</ul>
<h2 id="5、Atomikos-配置，创建-JTA-事务管理器"><a href="#5、Atomikos-配置，创建-JTA-事务管理器" class="headerlink" title="5、Atomikos 配置，创建 JTA 事务管理器"></a>5、Atomikos 配置，创建 JTA 事务管理器</h2><pre><code class="java">package com.example.config;

import com.atomikos.icatch.jta.UserTransactionImp;
import com.atomikos.icatch.jta.UserTransactionManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.jta.JtaTransactionManager;

import javax.transaction.SystemException;
import javax.transaction.TransactionManager;
import javax.transaction.UserTransaction;

@Configuration
public class JtaTransactionManagerConfig &#123;

    @Bean
    public UserTransaction userTransaction() throws SystemException &#123;
        UserTransactionImp userTransactionImp = new UserTransactionImp();
        userTransactionImp.setTransactionTimeout(10000);
        return userTransactionImp;
    &#125;

    @Bean(name = &quot;atomikosTransactionManager&quot;)
    public TransactionManager atomikosTransactionManager() &#123;
        UserTransactionManager userTransactionManager = new UserTransactionManager();
        userTransactionManager.setForceShutdown(false);
        return userTransactionManager;
    &#125;

    @Bean(name = &quot;transactionManager&quot;)
    @DependsOn(&#123;&quot;userTransaction&quot;, &quot;atomikosTransactionManager&quot;&#125;)
    public PlatformTransactionManager transactionManager() throws SystemException &#123;
        return new JtaTransactionManager(userTransaction(), atomikosTransactionManager());
    &#125;
&#125;
</code></pre>
<h2 id="6、编写-Controller-多数据源正常和异常情况"><a href="#6、编写-Controller-多数据源正常和异常情况" class="headerlink" title="6、编写 Controller 多数据源正常和异常情况"></a>6、编写 Controller 多数据源正常和异常情况</h2><pre><code class="java">package com.example.controller;

import com.atomikos.jdbc.AtomikosDataSourceBean;
import lombok.extern.slf4j.Slf4j;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import javax.annotation.PostConstruct;
import javax.annotation.Resource;
import java.util.List;
import java.util.Map;
import java.util.stream.Stream;

@Slf4j
@RestController
public class TestController &#123;

    @Resource(name = &quot;jdbcTemplate1&quot;)
    JdbcTemplate jdbcTemplate1;
    @Resource(name = &quot;jdbcTemplate2&quot;)
    JdbcTemplate jdbcTemplate2;

    /**
     * 给新增的数据源创建表和初始化数据
     */
    @PostConstruct
    public void init() &#123;
        Stream.of(jdbcTemplate1, jdbcTemplate2).forEach(jdbcTemplate -&gt; &#123;
            jdbcTemplate.execute(&quot;DROP TABLE IF EXISTS USER_INFO&quot;);
            jdbcTemplate.execute(&quot;CREATE TABLE USER_INFO (&quot;
                    + &quot;id BIGINT NOT NULL,&quot;
                    + &quot;name VARCHAR(50) DEFAULT NULL,&quot;
                    + &quot;type VARCHAR(50) DEFAULT NULL,&quot;
                    + &quot;PRIMARY KEY (id))&quot;);
            String sql = &quot;INSERT INTO USER_INFO (id, name, type) VALUES (?, ?, ?)&quot;;
            String resourceName = ((AtomikosDataSourceBean) jdbcTemplate.getDataSource()).getUniqueResourceName();
            jdbcTemplate.update(sql, 1, &quot;Jone&quot;, resourceName);
            jdbcTemplate.update(sql, 2, &quot;Tom&quot;, resourceName);
            jdbcTemplate.update(sql, 3, &quot;Sandy&quot;, resourceName);
        &#125;);
    &#125;

    @Transactional(transactionManager = &quot;transactionManager&quot;)
    @RequestMapping(&quot;/test&quot;)
    public String testOk1() &#123;
        jdbcTemplate1.execute(&quot;DELETE FROM USER_INFO WHERE id = 1&quot;);
        jdbcTemplate2.execute(&quot;DELETE FROM USER_INFO WHERE id = 1&quot;);
        return &quot;delete success&quot;;
    &#125;

    @Transactional(transactionManager = &quot;transactionManager&quot;)
    @RequestMapping(&quot;/testError&quot;)
    public String testError() &#123;
        jdbcTemplate1.execute(&quot;DELETE FROM USER_INFO WHERE id = 2&quot;);
        jdbcTemplate2.execute(&quot;DELETE FROM USER_INFO WHERE id = 2&quot;);
        int i = 1 / 0;
        return &quot;delete success&quot;;
    &#125;

    @RequestMapping(&quot;/db1&quot;)
    public List&lt;Map&lt;String, Object&gt;&gt; db1() &#123;
        return jdbcTemplate1.queryForList(&quot;SELECT * FROM USER_INFO&quot;);
    &#125;

    @RequestMapping(&quot;/db2&quot;)
    public List&lt;Map&lt;String, Object&gt;&gt; db2() &#123;
        return jdbcTemplate2.queryForList(&quot;SELECT * FROM USER_INFO&quot;);
    &#125;
&#125;
</code></pre>
<h2 id="7、测试多数据源正常情况"><a href="#7、测试多数据源正常情况" class="headerlink" title="7、测试多数据源正常情况"></a>7、测试多数据源正常情况</h2><pre><code class="bash">### 更新删除前先查询一次数据
curl -X GET &quot;localhost:8090/db1&quot;
[&#123;&quot;ID&quot;:1,&quot;NAME&quot;:&quot;Jone&quot;,&quot;TYPE&quot;:&quot;datasource1&quot;&#125;,&#123;&quot;ID&quot;:2,&quot;NAME&quot;:&quot;Tom&quot;,&quot;TYPE&quot;:&quot;datasource1&quot;&#125;,&#123;&quot;ID&quot;:3,&quot;NAME&quot;:&quot;Sandy&quot;,&quot;TYPE&quot;:&quot;datasource1&quot;&#125;]
curl -X GET &quot;localhost:8090/db2&quot;
[&#123;&quot;ID&quot;:1,&quot;NAME&quot;:&quot;Jone&quot;,&quot;TYPE&quot;:&quot;datasource2&quot;&#125;,&#123;&quot;ID&quot;:2,&quot;NAME&quot;:&quot;Tom&quot;,&quot;TYPE&quot;:&quot;datasource2&quot;&#125;,&#123;&quot;ID&quot;:3,&quot;NAME&quot;:&quot;Sandy&quot;,&quot;TYPE&quot;:&quot;datasource2&quot;&#125;]

### 执行删除操作
curl -X GET &quot;localhost:8090/test&quot;
delete success
### 控制台输出
2024-09-10 11:09:14.906 DEBUG 98251 --- [nio-8090-exec-4] o.s.t.jta.JtaTransactionManager          : Creating new transaction with name [com.example.controller.TestController.testOk1]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT; &#39;transactionManager&#39;
2024-09-10 11:09:14.935 DEBUG 98251 --- [nio-8090-exec-4] o.s.jdbc.core.JdbcTemplate               : Executing SQL statement [DELETE FROM USER_INFO WHERE id = 1]
2024-09-10 11:09:14.936 DEBUG 98251 --- [nio-8090-exec-4] o.s.jdbc.datasource.DataSourceUtils      : Fetching JDBC Connection from DataSource
2024-09-10 11:09:14.951 DEBUG 98251 --- [nio-8090-exec-4] o.s.jdbc.core.JdbcTemplate               : Executing SQL statement [DELETE FROM USER_INFO WHERE id = 1]
2024-09-10 11:09:14.951 DEBUG 98251 --- [nio-8090-exec-4] o.s.jdbc.datasource.DataSourceUtils      : Fetching JDBC Connection from DataSource
2024-09-10 11:09:14.953 DEBUG 98251 --- [nio-8090-exec-4] o.s.t.jta.JtaTransactionManager          : Initiating transaction commit

### 更新删除后再查询一次数据
curl -X GET &quot;localhost:8090/db1&quot;
[&#123;&quot;ID&quot;:2,&quot;NAME&quot;:&quot;Tom&quot;,&quot;TYPE&quot;:&quot;datasource1&quot;&#125;,&#123;&quot;ID&quot;:3,&quot;NAME&quot;:&quot;Sandy&quot;,&quot;TYPE&quot;:&quot;datasource1&quot;&#125;]
curl -X GET &quot;localhost:8090/db2&quot;
[&#123;&quot;ID&quot;:2,&quot;NAME&quot;:&quot;Tom&quot;,&quot;TYPE&quot;:&quot;datasource2&quot;&#125;,&#123;&quot;ID&quot;:3,&quot;NAME&quot;:&quot;Sandy&quot;,&quot;TYPE&quot;:&quot;datasource2&quot;&#125;]
</code></pre>
<h2 id="8、测试多数据源异常情况"><a href="#8、测试多数据源异常情况" class="headerlink" title="8、测试多数据源异常情况"></a>8、测试多数据源异常情况</h2><pre><code class="bash">### 执行删除操作
curl -X GET &quot;localhost:8090/testError&quot;
&#123;&quot;timestamp&quot;:&quot;2024-09-10T03:12:24.359+00:00&quot;,&quot;status&quot;:500,&quot;error&quot;:&quot;Internal Server Error&quot;,&quot;path&quot;:&quot;/testError&quot;&#125;
### 控制台输出
2024-09-10 11:12:24.294 DEBUG 98251 --- [nio-8090-exec-7] o.s.t.jta.JtaTransactionManager          : Creating new transaction with name [com.example.controller.TestController.testError]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT; &#39;transactionManager&#39;
2024-09-10 11:12:24.303 DEBUG 98251 --- [nio-8090-exec-7] o.s.jdbc.core.JdbcTemplate               : Executing SQL statement [DELETE FROM USER_INFO WHERE id = 2]
2024-09-10 11:12:24.303 DEBUG 98251 --- [nio-8090-exec-7] o.s.jdbc.datasource.DataSourceUtils      : Fetching JDBC Connection from DataSource
2024-09-10 11:12:24.309 DEBUG 98251 --- [nio-8090-exec-7] o.s.jdbc.core.JdbcTemplate               : Executing SQL statement [DELETE FROM USER_INFO WHERE id = 2]
2024-09-10 11:12:24.310 DEBUG 98251 --- [nio-8090-exec-7] o.s.jdbc.datasource.DataSourceUtils      : Fetching JDBC Connection from DataSource
2024-09-10 11:12:24.317 DEBUG 98251 --- [nio-8090-exec-7] o.s.t.jta.JtaTransactionManager          : Initiating transaction rollback
2024-09-10 11:12:24.349 ERROR 98251 --- [nio-8090-exec-7] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.ArithmeticException: / by zero] with root cause

### 更新删除后再查询一次数据
curl -X GET &quot;localhost:8090/db1&quot;
[&#123;&quot;ID&quot;:2,&quot;NAME&quot;:&quot;Tom&quot;,&quot;TYPE&quot;:&quot;datasource1&quot;&#125;,&#123;&quot;ID&quot;:3,&quot;NAME&quot;:&quot;Sandy&quot;,&quot;TYPE&quot;:&quot;datasource1&quot;&#125;]
curl -X GET &quot;localhost:8090/db2&quot;
[&#123;&quot;ID&quot;:2,&quot;NAME&quot;:&quot;Tom&quot;,&quot;TYPE&quot;:&quot;datasource2&quot;&#125;,&#123;&quot;ID&quot;:3,&quot;NAME&quot;:&quot;Sandy&quot;,&quot;TYPE&quot;:&quot;datasource2&quot;&#125;]
</code></pre>
<h1 id="SpringBoot-使用-Mybatis-Atomikos-实现分布式事务"><a href="#SpringBoot-使用-Mybatis-Atomikos-实现分布式事务" class="headerlink" title="SpringBoot 使用 Mybatis + Atomikos 实现分布式事务"></a>SpringBoot 使用 Mybatis + Atomikos 实现分布式事务</h1><h2 id="1、添加依赖-1"><a href="#1、添加依赖-1" class="headerlink" title="1、添加依赖"></a>1、添加依赖</h2><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.7.18&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;h2-mybaits-multi-transaction&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;h2-mybaits-multi-transaction&lt;/name&gt;
    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;

    &lt;properties&gt;
        &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-jta-atomikos&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
            &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;
            &lt;version&gt;2.3.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.h2database&lt;/groupId&gt;
            &lt;artifactId&gt;h2&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;
</code></pre>
<h2 id="2、在-application-yml-中配置多个数据源-1"><a href="#2、在-application-yml-中配置多个数据源-1" class="headerlink" title="2、在 application.yml 中配置多个数据源"></a>2、在 application.yml 中配置多个数据源</h2><pre><code class="yaml">server:
  port: 8090

#################### H2 数据库配置 ####################
# 文件数据库, jdbc:h2:file:./dbh2/dbc2m;AUTO_SERVER=TRUE
# 内存数据库，jdbc:h2:mem:master
spring:
  datasource1:
    unique-resource-name: datasource1
    xa-data-source-class-name: org.h2.jdbcx.JdbcDataSource
    xa-properties:
      url: jdbc:h2:mem:master
      user: sa
      password: sa
    exclusive-connection-mode: true
    min-pool-size: 3
    max-pool-size: 10
    max-lifetime: 20000
    borrow-connection-timeout: 10000
    test-query: SELECT 1 from dual # 由于采用HikariCP，用于检测数据库连接是否存活。
  datasource2:
    unique-resource-name: datasource2
    xa-data-source-class-name: org.h2.jdbcx.JdbcDataSource
    xa-properties:
      url: jdbc:h2:mem:slave
      user: sa
      password: sa
    exclusive-connection-mode: true
    min-pool-size: 3
    max-pool-size: 10
    max-lifetime: 20000
    borrow-connection-timeout: 10000
    test-query: SELECT 1 from dual # 由于采用HikariCP，用于检测数据库连接是否存活。

  #################### H2 Web Console设置 ####################
  ### enabled：程序开启时就会启动 H2 Web Console, 默认就是启动的
  ### path：配置访问地址为：/h2，访问 H2 Web Console，默认:/h2-console
  ### settings.web-allow-others：开启H2 Web Console远程访问，默认为false不开启只能在本机访问
  h2:
    console:
      enabled: true
      path: /h2
      settings:
        web-allow-others: true

### 开启控制台打印sql
mybatis:
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
</code></pre>
<h2 id="3、第一个数据源配置-1"><a href="#3、第一个数据源配置-1" class="headerlink" title="3、第一个数据源配置"></a>3、第一个数据源配置</h2><pre><code class="java">package com.example.config;

import org.apache.ibatis.logging.stdout.StdOutImpl;
import org.apache.ibatis.session.SqlSessionFactory;
import org.mybatis.spring.SqlSessionFactoryBean;
import org.mybatis.spring.SqlSessionTemplate;
import org.mybatis.spring.annotation.MapperScan;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.autoconfigure.EnableAutoConfiguration;
import org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jta.atomikos.AtomikosDataSourceBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.jdbc.datasource.DataSourceTransactionManager;
import org.springframework.transaction.PlatformTransactionManager;
import javax.sql.DataSource;

/**
 * @EnableAutoConfiguration 就是去掉springboot默认自动配置数据源
 */
@DependsOn(&quot;transactionManager&quot;)
@Configuration
@MapperScan(
        basePackages = &quot;com.example.mapper.db1&quot;,
        sqlSessionFactoryRef = &quot;sqlSessionFactory1&quot;,
        sqlSessionTemplateRef = &quot;sqlSessionTemplate1&quot;)
@EnableAutoConfiguration(exclude = &#123;DataSourceAutoConfiguration.class&#125;)
public class MybatisDataSource1Config &#123;

    @Bean(name = &quot;datasource1&quot;)
    @ConfigurationProperties(prefix = &quot;spring.datasource1&quot;)
    public DataSource datasource1() &#123;
        // 这里是关键，返回的是AtomikosDataSourceBean，所有的配置属性也都是注入到这个类里面
        return new AtomikosDataSourceBean();
    &#125;

    /**
     * Spring-Mybatis 配置第一步：配置SqlSessionFactory
     */
    @Bean(name = &quot;sqlSessionFactory1&quot;)
    public SqlSessionFactory sqlSessionFactory1(@Qualifier(&quot;datasource1&quot;) DataSource datasource1) throws Exception &#123;
        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();
        bean.setDataSource(datasource1); // 传入数据源
        // 指定扫描的xml文件所在位置，在配置文件里面配置，会报Invalid bound statement
        // bean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(&quot;classpath:mapper/*.xml&quot;));
        org.apache.ibatis.session.Configuration configuration = new org.apache.ibatis.session.Configuration();
        configuration.setMapUnderscoreToCamelCase(true); // 开启驼峰转换
        configuration.setLogImpl(StdOutImpl.class); // 配置SQL日志
        bean.setConfiguration(configuration);
        return bean.getObject();
    &#125;

    /**
     * Spring-Mybatis 配置第二步：配置SqlSessionTemplate
     */
    @Bean(name = &quot;sqlSessionTemplate1&quot;)
    public SqlSessionTemplate sqlSessionTemplate1(@Qualifier(&quot;sqlSessionFactory1&quot;) SqlSessionFactory sqlSessionFactory1) &#123;
        return new SqlSessionTemplate(sqlSessionFactory1);
    &#125;

    /**
     * 事务管理
     * Spring-Mybatis 配置第三步：配置DataSourceTransactionManager
     */
    @Bean(name = &quot;transactionManager1&quot;)
    public PlatformTransactionManager transactionManager1(@Qualifier(&quot;datasource1&quot;) DataSource datasource1) &#123;
        return new DataSourceTransactionManager(datasource1);
    &#125;
&#125;
</code></pre>
<ul>
<li>这里需要注意：数据源和 sqlSessionFactory 需要在 JTA transactionManager 创建后创建。</li>
</ul>
<h2 id="4、第二个数据源配置-1"><a href="#4、第二个数据源配置-1" class="headerlink" title="4、第二个数据源配置"></a>4、第二个数据源配置</h2><pre><code class="java">package com.example.config;

import org.apache.ibatis.logging.stdout.StdOutImpl;
import org.apache.ibatis.session.SqlSessionFactory;
import org.mybatis.spring.SqlSessionFactoryBean;
import org.mybatis.spring.SqlSessionTemplate;
import org.mybatis.spring.annotation.MapperScan;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jta.atomikos.AtomikosDataSourceBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.jdbc.datasource.DataSourceTransactionManager;
import org.springframework.transaction.PlatformTransactionManager;

import javax.sql.DataSource;

@DependsOn(&quot;transactionManager&quot;)
@Configuration
@MapperScan(
        basePackages = &quot;com.example.mapper.db2&quot;,
        sqlSessionFactoryRef = &quot;sqlSessionFactory2&quot;,
        sqlSessionTemplateRef = &quot;sqlSessionTemplate2&quot;)
public class MybatisDataSource2Config &#123;

    @Bean(name = &quot;datasource2&quot;)
    @ConfigurationProperties(prefix = &quot;spring.datasource2&quot;)
    public DataSource datasource2() &#123;
        // 这里是关键，返回的是AtomikosDataSourceBean，所有的配置属性也都是注入到这个类里面
        return new AtomikosDataSourceBean();
    &#125;

    /**
     * Spring-Mybatis 配置第一步：配置SqlSessionFactory
     */
    @Bean(name = &quot;sqlSessionFactory2&quot;)
    public SqlSessionFactory sqlSessionFactory2(@Qualifier(&quot;datasource2&quot;) DataSource datasource2) throws Exception &#123;
        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();
        bean.setDataSource(datasource2); // 传入数据源
        // 指定扫描的xml文件所在位置，在配置文件里面配置，会报Invalid bound statement
        // bean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(&quot;classpath:mapper/*.xml&quot;));
        org.apache.ibatis.session.Configuration configuration = new org.apache.ibatis.session.Configuration();
        configuration.setMapUnderscoreToCamelCase(true); // 开启驼峰转换
        configuration.setLogImpl(StdOutImpl.class); // 配置SQL日志
        bean.setConfiguration(configuration);
        return bean.getObject();
    &#125;

    /**
     * Spring-Mybatis 配置第二步：配置SqlSessionTemplate
     */
    @Bean(name = &quot;sqlSessionTemplate2&quot;)
    public SqlSessionTemplate sqlSessionTemplate2(@Qualifier(&quot;sqlSessionFactory2&quot;) SqlSessionFactory sqlSessionFactory2) &#123;
        return new SqlSessionTemplate(sqlSessionFactory2);
    &#125;

    /**
     * 事务管理
     * Spring-Mybatis 配置第三步：配置DataSourceTransactionManager
     */
    @Bean(name = &quot;transactionManager2&quot;)
    public PlatformTransactionManager transactionManager2(@Qualifier(&quot;datasource2&quot;) DataSource datasource2) &#123;
        return new DataSourceTransactionManager(datasource2);
    &#125;
&#125;
</code></pre>
<ul>
<li>这里需要注意：数据源和 sqlSessionFactory 需要在 JTA transactionManager 创建后创建。</li>
</ul>
<h2 id="5、Atomikos-配置，创建-JTA-事务管理器-1"><a href="#5、Atomikos-配置，创建-JTA-事务管理器-1" class="headerlink" title="5、Atomikos 配置，创建 JTA 事务管理器"></a>5、Atomikos 配置，创建 JTA 事务管理器</h2><pre><code class="java">package com.example.config;

import com.atomikos.icatch.jta.UserTransactionImp;
import com.atomikos.icatch.jta.UserTransactionManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.jta.JtaTransactionManager;

import javax.transaction.SystemException;
import javax.transaction.TransactionManager;
import javax.transaction.UserTransaction;

@Configuration
public class JtaTransactionManagerConfig &#123;

    @Bean
    public UserTransaction userTransaction() throws SystemException &#123;
        UserTransactionImp userTransactionImp = new UserTransactionImp();
        userTransactionImp.setTransactionTimeout(10000);
        return userTransactionImp;
    &#125;

    @Bean(name = &quot;atomikosTransactionManager&quot;)
    public TransactionManager atomikosTransactionManager() &#123;
        UserTransactionManager userTransactionManager = new UserTransactionManager();
        userTransactionManager.setForceShutdown(false);
        return userTransactionManager;
    &#125;

    @Bean(name = &quot;transactionManager&quot;)
    @DependsOn(&#123;&quot;userTransaction&quot;, &quot;atomikosTransactionManager&quot;&#125;)
    public PlatformTransactionManager transactionManager() throws SystemException &#123;
        return new JtaTransactionManager(userTransaction(), atomikosTransactionManager());
    &#125;
&#125;
</code></pre>
<h2 id="6、编写数据库实体类以及-Mapper"><a href="#6、编写数据库实体类以及-Mapper" class="headerlink" title="6、编写数据库实体类以及 Mapper"></a>6、编写数据库实体类以及 Mapper</h2><p>1、数据库对应实体类 UserInfo</p>
<pre><code class="java">package com.example.entity;
import lombok.Data;
import java.io.Serializable;

@Data
public class UserInfo implements Serializable &#123;
    private Integer id;
    private String name;
    private String type;
&#125;
</code></pre>
<p>2、数据源一对应的 Mapper 接口：UserMapper1</p>
<pre><code class="java">package com.example.mapper.db1;

import com.example.entity.UserInfo;
import org.apache.ibatis.annotations.*;
import java.util.List;

public interface UserMapper1 &#123;
    @Select(&quot;select * from USER_INFO&quot;)
    List&lt;UserInfo&gt; findAll();

    @Update(&quot;drop table if exists USER_INFO;&quot;)
    void dropUserExistTable();

    @Update(&quot;create TABLE USER_INFO (id BIGINT NOT NULL AUTO_INCREMENT,name VARCHAR(50) DEFAULT NULL,type VARCHAR(50) DEFAULT NULL,PRIMARY KEY (id))&quot;)
    void createUserTable();

    @Insert(&quot;insert into USER_INFO (id, name, type) values (1, &#39;Jone&#39;, #&#123;type&#125;),(2, &#39;Tom&#39;, #&#123;type&#125;),(3, &#39;Sandy&#39;, #&#123;type&#125;);&quot;)
    int initTableData(@Param(&quot;type&quot;) String type);

    @Delete(&quot;delete from USER_INFO where id = #&#123;id&#125;&quot;)
    int deleteById(@Param(&quot;id&quot;) Integer id);
&#125;
</code></pre>
<p>3、数据源二对应的 Mapper 接口：UserMapper2</p>
<pre><code class="java">package com.example.mapper.db2;

import com.example.entity.UserInfo;
import org.apache.ibatis.annotations.*;
import java.util.List;

public interface UserMapper2 &#123;
    @Select(&quot;select * from USER_INFO&quot;)
    List&lt;UserInfo&gt; findAll();

    @Update(&quot;drop table if exists USER_INFO;&quot;)
    void dropUserExistTable();

    @Update(&quot;create TABLE USER_INFO (id BIGINT NOT NULL AUTO_INCREMENT,name VARCHAR(50) DEFAULT NULL,type VARCHAR(50) DEFAULT NULL,PRIMARY KEY (id))&quot;)
    void createUserTable();

    @Insert(&quot;insert into USER_INFO (id, name, type) values (1, &#39;Jone&#39;, #&#123;type&#125;),(2, &#39;Tom&#39;, #&#123;type&#125;),(3, &#39;Sandy&#39;, #&#123;type&#125;);&quot;)
    int initTableData(@Param(&quot;type&quot;) String type);

    @Delete(&quot;delete from USER_INFO where id = #&#123;id&#125;&quot;)
    int deleteById(@Param(&quot;id&quot;) Integer id);
&#125;
</code></pre>
<h2 id="7、编写-Controller-多数据源正常和异常情况"><a href="#7、编写-Controller-多数据源正常和异常情况" class="headerlink" title="7、编写 Controller 多数据源正常和异常情况"></a>7、编写 Controller 多数据源正常和异常情况</h2><pre><code class="java">package com.example.controller;

import com.example.entity.UserInfo;
import com.example.mapper.db1.UserMapper1;
import com.example.mapper.db2.UserMapper2;
import lombok.extern.slf4j.Slf4j;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import javax.annotation.PostConstruct;
import javax.annotation.Resource;
import java.util.List;

@Slf4j
@RestController
public class TestController &#123;

    @Resource
    UserMapper1 userMapper1;
    @Resource
    UserMapper2 userMapper2;

    @PostConstruct
    public String initData() &#123;
        userMapper1.dropUserExistTable();
        userMapper1.createUserTable();
        userMapper1.initTableData(&quot;datasource1&quot;);
        userMapper2.dropUserExistTable();
        userMapper2.createUserTable();
        userMapper2.initTableData(&quot;datasource2&quot;);
        return &quot;init data success&quot;;
    &#125;

    @Transactional(transactionManager = &quot;transactionManager&quot;)
    @RequestMapping(&quot;/test&quot;)
    public String test() &#123;
        userMapper1.deleteById(1);
        userMapper2.deleteById(1);
        return &quot;delete success&quot;;
    &#125;

    @Transactional(transactionManager = &quot;transactionManager&quot;)
    @RequestMapping(&quot;/testError&quot;)
    public String testError() &#123;
        userMapper1.deleteById(1);
        userMapper2.deleteById(1);
        int i = 1 / 0;
        return &quot;delete success&quot;;
    &#125;


    @RequestMapping(&quot;/db1&quot;)
    public List&lt;UserInfo&gt; db1() &#123;
        return userMapper1.findAll();
    &#125;

    @RequestMapping(&quot;/db2&quot;)
    public List&lt;UserInfo&gt; db2() &#123;
        return userMapper2.findAll();
    &#125;

&#125;
</code></pre>
<h2 id="8、测试多数据源正常情况"><a href="#8、测试多数据源正常情况" class="headerlink" title="8、测试多数据源正常情况"></a>8、测试多数据源正常情况</h2><pre><code class="bash">### 更新删除前先查询一次数据
curl -X GET &quot;localhost:8090/db1&quot;
[&#123;&quot;id&quot;:1,&quot;name&quot;:&quot;Jone&quot;,&quot;type&quot;:&quot;datasource1&quot;&#125;,&#123;&quot;id&quot;:2,&quot;name&quot;:&quot;Tom&quot;,&quot;type&quot;:&quot;datasource1&quot;&#125;,&#123;&quot;id&quot;:3,&quot;name&quot;:&quot;Sandy&quot;,&quot;type&quot;:&quot;datasource1&quot;&#125;]
curl -X GET &quot;localhost:8090/db2&quot;
[&#123;&quot;id&quot;:1,&quot;name&quot;:&quot;Jone&quot;,&quot;type&quot;:&quot;datasource2&quot;&#125;,&#123;&quot;id&quot;:2,&quot;name&quot;:&quot;Tom&quot;,&quot;type&quot;:&quot;datasource2&quot;&#125;,&#123;&quot;id&quot;:3,&quot;name&quot;:&quot;Sandy&quot;,&quot;type&quot;:&quot;datasource2&quot;&#125;]

### 执行删除操作
curl -X GET &quot;localhost:8090/test&quot;
delete success
### 控制台输出
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6833f290]
JDBC Connection [conn2: url=jdbc:h2:mem:master user=SA] will be managed by Spring
==&gt;  Preparing: delete from USER_INFO where id = ?
==&gt; Parameters: 1(Integer)
&lt;==    Updates: 1
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6833f290]
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64914ab4]
JDBC Connection [conn9: url=jdbc:h2:mem:slave user=SA] will be managed by Spring
==&gt;  Preparing: delete from USER_INFO where id = ?
==&gt; Parameters: 1(Integer)
&lt;==    Updates: 1
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64914ab4]
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6833f290]
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64914ab4]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6833f290]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6833f290]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64914ab4]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@64914ab4]

### 更新删除后再查询一次数据
curl -X GET &quot;localhost:8090/db1&quot;
[&#123;&quot;id&quot;:2,&quot;name&quot;:&quot;Tom&quot;,&quot;type&quot;:&quot;datasource1&quot;&#125;,&#123;&quot;id&quot;:3,&quot;name&quot;:&quot;Sandy&quot;,&quot;type&quot;:&quot;datasource1&quot;&#125;]
curl -X GET &quot;localhost:8090/db2&quot;
[&#123;&quot;id&quot;:2,&quot;name&quot;:&quot;Tom&quot;,&quot;type&quot;:&quot;datasource2&quot;&#125;,&#123;&quot;id&quot;:3,&quot;name&quot;:&quot;Sandy&quot;,&quot;type&quot;:&quot;datasource2&quot;&#125;]
</code></pre>
<h2 id="9、测试多数据源异常情况"><a href="#9、测试多数据源异常情况" class="headerlink" title="9、测试多数据源异常情况"></a>9、测试多数据源异常情况</h2><pre><code class="bash">### 执行删除操作
curl -X GET &quot;localhost:8090/testError&quot;
&#123;&quot;timestamp&quot;:&quot;2024-09-10T03:29:24.635+00:00&quot;,&quot;status&quot;:500,&quot;error&quot;:&quot;Internal Server Error&quot;,&quot;path&quot;:&quot;/testError&quot;&#125;
### 控制台输出
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45135b31]
JDBC Connection [conn2: url=jdbc:h2:mem:master user=SA] will be managed by Spring
==&gt;  Preparing: delete from USER_INFO where id = ?
==&gt; Parameters: 1(Integer)
&lt;==    Updates: 0
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45135b31]
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@253ca47e]
JDBC Connection [conn9: url=jdbc:h2:mem:slave user=SA] will be managed by Spring
==&gt;  Preparing: delete from USER_INFO where id = ?
==&gt; Parameters: 1(Integer)
&lt;==    Updates: 0
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@253ca47e]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45135b31]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@45135b31]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@253ca47e]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@253ca47e]
2024-09-10 11:29:24.622 ERROR 99240 --- [nio-8090-exec-6] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.ArithmeticException: / by zero] with root cause

### 更新删除后再查询一次数据
curl -X GET &quot;localhost:8090/db1&quot;
[&#123;&quot;id&quot;:2,&quot;name&quot;:&quot;Tom&quot;,&quot;type&quot;:&quot;datasource1&quot;&#125;,&#123;&quot;id&quot;:3,&quot;name&quot;:&quot;Sandy&quot;,&quot;type&quot;:&quot;datasource1&quot;&#125;]
curl -X GET &quot;localhost:8090/db2&quot;
[&#123;&quot;id&quot;:2,&quot;name&quot;:&quot;Tom&quot;,&quot;type&quot;:&quot;datasource2&quot;&#125;,&#123;&quot;id&quot;:3,&quot;name&quot;:&quot;Sandy&quot;,&quot;type&quot;:&quot;datasource2&quot;&#125;]
</code></pre>
<h1 id="SpringBoot-使用-JPA-Atomikos-实现分布式事务"><a href="#SpringBoot-使用-JPA-Atomikos-实现分布式事务" class="headerlink" title="SpringBoot 使用 JPA + Atomikos 实现分布式事务"></a>SpringBoot 使用 JPA + Atomikos 实现分布式事务</h1><h2 id="1、添加依赖-2"><a href="#1、添加依赖-2" class="headerlink" title="1、添加依赖"></a>1、添加依赖</h2><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;2.7.18&lt;/version&gt;
        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;
    &lt;/parent&gt;
    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;h2-jpa-multi-transaction&lt;/artifactId&gt;
    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;h2-jpa-multi-transaction&lt;/name&gt;
    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;
    &lt;properties&gt;
        &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;
    &lt;/properties&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-jta-atomikos&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.h2database&lt;/groupId&gt;
            &lt;artifactId&gt;h2&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;
</code></pre>
<h2 id="2、在-application-yml-中配置多个数据源-2"><a href="#2、在-application-yml-中配置多个数据源-2" class="headerlink" title="2、在 application.yml 中配置多个数据源"></a>2、在 application.yml 中配置多个数据源</h2><pre><code class="yaml">server:
  port: 8090

#################### H2 数据库配置 ####################
# 文件数据库, jdbc:h2:file:./dbh2/dbc2m;AUTO_SERVER=TRUE
# 内存数据库，jdbc:h2:mem:master
spring:
  jta:
    enabled: true
    transaction-manager-id: atomikosTransactionManager
  datasource1:
    unique-resource-name: primaryDataSource
    xa-data-source-class-name: org.h2.jdbcx.JdbcDataSource
    xa-properties:
      url: jdbc:h2:mem:master
      user: sa
      password:
    exclusive-connection-mode: true
    min-pool-size: 3
    max-pool-size: 10
    max-lifetime: 20000
    borrow-connection-timeout: 10000
    test-query: SELECT 1 from dual # 由于采用HikariCP，用于检测数据库连接是否存活。
  datasource2:
    unique-resource-name: secondaryDataSource
    xa-data-source-class-name: org.h2.jdbcx.JdbcDataSource
    xa-properties:
      url: jdbc:h2:mem:slave
      user: sa
      password:
    exclusive-connection-mode: true
    min-pool-size: 3
    max-pool-size: 10
    max-lifetime: 20000
    borrow-connection-timeout: 10000
    test-query: SELECT 1 from dual # 由于采用HikariCP，用于检测数据库连接是否存活。

  #################### JPA 的配置 ####################
  # database-platform: 数据库方言的配置
  # hibernate.ddl-auto = none, 不启动 jpa 的自动通过实体类自动建表功能
  # show-sql = true 开启 SQL 打印功能
  # properties.hibernate.format_sql = true 开启SQL格式化功能
  jpa:
    database-platform: org.hibernate.dialect.H2Dialect
    hibernate:
      ddl-auto: create
    properties:
      # spring.jpa.properties.javax.persistence.transactionType
      # spring.jpa.properties.hibernate.transaction.jta.platform
      # 使用JPA 整合 JTA-Atomikos 分布式事务时必须配置这两个配置
      javax:
        persistence:
          transactionType: JTA
      hibernate:
        transaction:
          jta:
            platform: org.hibernate.engine.transaction.jta.platform.internal.AtomikosJtaPlatform # 处理事务的类
        format_sql: false
    show-sql: true
    open-in-view: false

  #################### H2 Web Console设置 ####################
  ### enabled：程序开启时就会启动 H2 Web Console, 默认就是启动的
  ### path：配置访问地址为：/h2，访问 H2 Web Console，默认:/h2-console
  ### settings.web-allow-others：开启H2 Web Console远程访问，默认为false不开启只能在本机访问
  h2:
    console:
      enabled: true
      path: /h2
      settings:
        web-allow-others: true

## 此配置是为了调试, 每个HTTP请求进来会打印 Open Hibernate 和 Open Session, 还有从当前线程中取出EntityManager ##
#################### 修改日志级别 ####################
logging:
  level:
    org.hibernate.engine.transaction.internal: trace
    org.springframework.orm.jpa.JpaTransactionManager: trace
    org.hibernate.internal: trace
</code></pre>
<p>注意：在使用 JPA 整合 JTA-Atomikos 时，必须要配置如下2个配置：</p>
<ul>
<li>spring.jpa.properties.javax.persistence.transactionType</li>
<li>spring.jpa.properties.hibernate.transaction.jta.platform</li>
</ul>
<h2 id="3、第一个数据源配置-2"><a href="#3、第一个数据源配置-2" class="headerlink" title="3、第一个数据源配置"></a>3、第一个数据源配置</h2><pre><code class="java">package com.example.config;

import org.springframework.boot.autoconfigure.orm.jpa.HibernateProperties;
import org.springframework.boot.autoconfigure.orm.jpa.HibernateSettings;
import org.springframework.boot.autoconfigure.orm.jpa.JpaProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jta.atomikos.AtomikosDataSourceBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.context.annotation.Primary;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.Database;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;

import javax.annotation.Resource;
import javax.sql.DataSource;
import java.util.Map;

@DependsOn(&quot;transactionManager&quot;)
@Configuration
@EnableJpaRepositories(
        basePackages = &quot;com.example.repository.db1&quot;, // 扫描repository并注入到Spring容器
        entityManagerFactoryRef = &quot;entityManagerFactoryBean1&quot;,
        transactionManagerRef = &quot;transactionManager&quot;)
public class JpaAndDatasource1Config &#123;

    @Resource
    HibernateProperties hibernateProperties;
    @Resource
    JpaProperties jpaProperties;

    @Primary
    @Bean(name = &quot;datasource1&quot;, initMethod = &quot;init&quot;, destroyMethod = &quot;close&quot;)
    @ConfigurationProperties(prefix = &quot;spring.datasource1&quot;)
    public DataSource datasource1() &#123;
        return new AtomikosDataSourceBean();
    &#125;

    @Primary
    @Bean(name = &quot;entityManagerFactoryBean1&quot;)
    public LocalContainerEntityManagerFactoryBean entityManagerFactoryBean1() &#123;
        // 设置JPA特性
        HibernateJpaVendorAdapter jpaVendorAdapter = new HibernateJpaVendorAdapter();
        jpaVendorAdapter.setShowSql(true); // 显示SQL
        jpaVendorAdapter.setGenerateDdl(true); // 自动生成/更新表
        jpaVendorAdapter.setDatabase(Database.H2); // 设置数据库类型

        // 设置JPAProperties + HibernateProperties 配置
        Map&lt;String, Object&gt; properties = hibernateProperties
                .determineHibernateProperties(jpaProperties.getProperties(), new HibernateSettings());
        LocalContainerEntityManagerFactoryBean entityManager = new LocalContainerEntityManagerFactoryBean();
        entityManager.setJtaDataSource(datasource1());
        entityManager.setJpaVendorAdapter(jpaVendorAdapter);
        // 这里要修改成主数据源的扫描包
        entityManager.setPackagesToScan(&quot;com.example.entity.db1&quot;);
        entityManager.setPersistenceUnitName(&quot;persistenceUnit1&quot;);
        entityManager.setJpaPropertyMap(properties);
        return entityManager;
    &#125;
&#125;
</code></pre>
<ul>
<li>这里需要注意：数据源和 entityManagerFactoryBean 需要在 JTA transactionManager 创建后创建。</li>
</ul>
<h2 id="4、第二个数据源配置-2"><a href="#4、第二个数据源配置-2" class="headerlink" title="4、第二个数据源配置"></a>4、第二个数据源配置</h2><pre><code class="java">package com.example.config;

import org.springframework.boot.autoconfigure.orm.jpa.HibernateProperties;
import org.springframework.boot.autoconfigure.orm.jpa.HibernateSettings;
import org.springframework.boot.autoconfigure.orm.jpa.JpaProperties;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jta.atomikos.AtomikosDataSourceBean;
import org.springframework.boot.orm.jpa.EntityManagerFactoryBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.data.jpa.repository.config.EnableJpaRepositories;
import org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean;
import org.springframework.orm.jpa.vendor.Database;
import org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter;

import javax.annotation.Resource;
import javax.sql.DataSource;
import java.util.Map;

@DependsOn(&quot;transactionManager&quot;)
@Configuration
@EnableJpaRepositories(
        basePackages = &quot;com.example.repository.db2&quot;, // 扫描repository并注入到Spring容器
        entityManagerFactoryRef = &quot;entityManagerFactoryBean2&quot;,
        transactionManagerRef = &quot;transactionManager&quot;)
public class JpaAndDatasource2Config &#123;

    @Resource
    HibernateProperties hibernateProperties;
    @Resource
    JpaProperties jpaProperties;

    @Bean(name = &quot;datasource2&quot;, initMethod = &quot;init&quot;, destroyMethod = &quot;close&quot;)
    @ConfigurationProperties(prefix = &quot;spring.datasource2&quot;)
    public DataSource datasource2() &#123;
        return new AtomikosDataSourceBean();
    &#125;

    @Bean(name = &quot;entityManagerFactoryBean2&quot;)
    public LocalContainerEntityManagerFactoryBean entityManagerFactoryBean2(EntityManagerFactoryBuilder builder) &#123;
        // 设置JPA特性
        HibernateJpaVendorAdapter jpaVendorAdapter = new HibernateJpaVendorAdapter();
        jpaVendorAdapter.setShowSql(true); // 显示SQL
        jpaVendorAdapter.setGenerateDdl(true); // 自动生成/更新表
        jpaVendorAdapter.setDatabase(Database.H2); // 设置数据库类型

        // 设置JPAProperties + HibernateProperties 配置
        Map&lt;String, Object&gt; properties = hibernateProperties
                .determineHibernateProperties(jpaProperties.getProperties(), new HibernateSettings());
        // 如下也可以放到 properties/yml 中配置
        properties.put(&quot;hibernate.transaction.jta.platform&quot;,
                &quot;org.hibernate.engine.transaction.jta.platform.internal.AtomikosJtaPlatform&quot;);
        properties.put(&quot;javax.persistence.transactionType&quot;, &quot;JTA&quot;);

        LocalContainerEntityManagerFactoryBean entityManagerFactoryBean = builder
                .dataSource(datasource2())
                .jta(true)
                .packages(&quot;com.example.entity.db2&quot;) // 扫描Entity的包
                .persistenceUnit(&quot;persistenceUnit2&quot;)
                .properties(properties)
                .build();
        entityManagerFactoryBean.setJpaVendorAdapter(jpaVendorAdapter);
        return entityManagerFactoryBean;
    &#125;
&#125;
</code></pre>
<ul>
<li>这里需要注意：数据源和 entityManagerFactoryBean 需要在 JTA transactionManager 创建后创建。</li>
</ul>
<h2 id="5、Atomikos-配置，创建-JTA-事务管理器-2"><a href="#5、Atomikos-配置，创建-JTA-事务管理器-2" class="headerlink" title="5、Atomikos 配置，创建 JTA 事务管理器"></a>5、Atomikos 配置，创建 JTA 事务管理器</h2><pre><code class="java">package com.example.config;

import com.atomikos.icatch.jta.UserTransactionImp;
import com.atomikos.icatch.jta.UserTransactionManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.DependsOn;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.jta.JtaTransactionManager;

import javax.transaction.SystemException;
import javax.transaction.TransactionManager;
import javax.transaction.UserTransaction;

/**
 * JTA-Atomikos 配置
 */
@Configuration
public class JtaAtomikosTransactionConfig &#123;

    @Bean(name = &quot;userTransaction&quot;)
    public UserTransaction userTransaction() throws SystemException &#123;
        UserTransactionImp userTransactionImp = new UserTransactionImp();
        userTransactionImp.setTransactionTimeout(10000);
        return userTransactionImp;
    &#125;

    @Bean(name = &quot;atomikosTransactionManager&quot;, initMethod = &quot;init&quot;, destroyMethod = &quot;close&quot;)
    public TransactionManager atomikosTransactionManager() &#123;
        UserTransactionManager userTransactionManager = new UserTransactionManager();
        userTransactionManager.setForceShutdown(false);
        return userTransactionManager;
    &#125;

    @Bean(name = &quot;transactionManager&quot;)
    @DependsOn(&#123;&quot;userTransaction&quot;, &quot;atomikosTransactionManager&quot;&#125;)
    public PlatformTransactionManager transactionManager() throws SystemException &#123;
        UserTransaction userTransaction = userTransaction();
        TransactionManager atomikosTransactionManager = atomikosTransactionManager();
        return new JtaTransactionManager(userTransaction, atomikosTransactionManager);
    &#125;
&#125;
</code></pre>
<h2 id="6、编写-Entity-与-Repository"><a href="#6、编写-Entity-与-Repository" class="headerlink" title="6、编写 Entity 与 Repository"></a>6、编写 Entity 与 Repository</h2><p>1、数据源一的 Entity</p>
<pre><code class="java">package com.example.entity.db1;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Table;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Entity
@Table(name = &quot;USER_INFO&quot;)
public class UserInfo1 &#123;
    @Id
    private Integer id;
    private String name;
    private String type;
&#125;
</code></pre>
<p>2、数据源二的 Entity</p>
<pre><code class="java">package com.example.entity.db2;

import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import javax.persistence.Entity;
import javax.persistence.Id;
import javax.persistence.Table;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Entity
@Table(name = &quot;USER_INFO&quot;)
public class UserInfo2 &#123;
    @Id
    private Integer id;
    private String name;
    private String type;
&#125;
</code></pre>
<p>3、数据源一的 Repository</p>
<pre><code class="java">package com.example.repository.db1;

import com.example.entity.db1.UserInfo1;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.transaction.annotation.Transactional;

public interface UserInfoRepository1 extends JpaRepository&lt;UserInfo1, Integer&gt; &#123;
    @Modifying
    @Transactional
    @Query(value = &quot;drop table if exists USER_INFO;&quot;,nativeQuery=true)
    void dropUserExistTable();

    @Modifying
    @Transactional
    @Query( value= &quot;create TABLE USER_INFO (id BIGINT NOT NULL AUTO_INCREMENT,name VARCHAR(50) DEFAULT NULL,type VARCHAR(50) DEFAULT NULL,PRIMARY KEY (id))&quot;,nativeQuery=true)
    void createUserTable();

    @Modifying
    @Transactional
    @Query(value=&quot;insert into USER_INFO (id, name, type) values (1, &#39;Jone&#39;, :type),(2, &#39;Tom&#39;, :type),(3, &#39;Sandy&#39;, :type);&quot;,nativeQuery=true)
    int initTableData(@Param(&quot;type&quot;)String type);
&#125;
</code></pre>
<p>4、数据源二的 Repository</p>
<pre><code class="java">package com.example.repository.db2;

import com.example.entity.db2.UserInfo2;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.query.Param;
import org.springframework.transaction.annotation.Transactional;

public interface UserInfoRepository2 extends JpaRepository&lt;UserInfo2, Integer&gt; &#123;
    @Modifying
    @Transactional
    @Query(value = &quot;drop table if exists USER_INFO;&quot;,nativeQuery=true)
    void dropUserExistTable();

    @Modifying
    @Transactional
    @Query( value= &quot;create TABLE USER_INFO (id BIGINT NOT NULL AUTO_INCREMENT,name VARCHAR(50) DEFAULT NULL,type VARCHAR(50) DEFAULT NULL,PRIMARY KEY (id))&quot;,nativeQuery=true)
    void createUserTable();

    @Modifying
    @Transactional
    @Query(value=&quot;insert into USER_INFO (id, name, type) values (1, &#39;Jone&#39;, :type),(2, &#39;Tom&#39;, :type),(3, &#39;Sandy&#39;, :type);&quot;,nativeQuery=true)
    int initTableData(@Param(&quot;type&quot;)String type);
&#125;
</code></pre>
<h2 id="7、编写-Controller-多数据源正常和异常情况-1"><a href="#7、编写-Controller-多数据源正常和异常情况-1" class="headerlink" title="7、编写 Controller 多数据源正常和异常情况"></a>7、编写 Controller 多数据源正常和异常情况</h2><pre><code class="java">package com.example.controller;

import com.example.entity.db1.UserInfo1;
import com.example.entity.db2.UserInfo2;
import com.example.repository.db1.UserInfoRepository1;
import com.example.repository.db2.UserInfoRepository2;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import java.util.List;

@RestController
public class TestController &#123;

    @Autowired
    private UserInfoRepository1 userInfoRepository1;
    @Autowired
    private UserInfoRepository2 userInfoRepository2;

    @Transactional
    @RequestMapping(&quot;/test&quot;)
    public String test() &#123;
        userInfoRepository1.save(new UserInfo1(1, &quot;Sam&quot;, &quot;dataSource1&quot;));
        userInfoRepository2.save(new UserInfo2(1, &quot;Meir&quot;, &quot;dataSource2&quot;));
        return &quot;ok&quot;;
    &#125;

    @Transactional
    @RequestMapping(&quot;/testError&quot;)
    public String testError() &#123;
        userInfoRepository1.save(new UserInfo1(2, &quot;Sam&quot;, &quot;dataSource1&quot;));
        userInfoRepository2.save(new UserInfo2(2, &quot;Meir&quot;, &quot;dataSource2&quot;));
        int i = 1/0;
        return &quot;ok&quot;;
    &#125;

    @RequestMapping(&quot;/db1&quot;)
    public List&lt;UserInfo1&gt; master() &#123;
        return userInfoRepository1.findAll();
    &#125;

    @RequestMapping(&quot;/db2&quot;)
    public List&lt;UserInfo2&gt; slave() &#123;
        return userInfoRepository2.findAll();
    &#125;
&#125;
</code></pre>
<h2 id="8、测试多数据源正常情况-1"><a href="#8、测试多数据源正常情况-1" class="headerlink" title="8、测试多数据源正常情况"></a>8、测试多数据源正常情况</h2><pre><code class="bash">### 执行新增数据操作
curl -X GET &quot;localhost:8090/test&quot;
ok
### 控制台输出
2024-09-10 11:50:59.899  INFO 906 --- [nio-8090-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet &#39;dispatcherServlet&#39;
2024-09-10 11:50:59.901  INFO 906 --- [nio-8090-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet &#39;dispatcherServlet&#39;
2024-09-10 11:50:59.905  INFO 906 --- [nio-8090-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2024-09-10 11:50:59.996 TRACE 906 --- [nio-8090-exec-1] .i.SessionFactoryImpl$SessionBuilderImpl : Opening Hibernate Session.  tenant=null
2024-09-10 11:50:59.999 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : Opened Session [1d911323-5d78-4bd0-9935-ee3a72ad8ecb] at timestamp: 1725940259999
Hibernate: select userinfo1x0_.id as id1_0_0_, userinfo1x0_.name as name2_0_0_, userinfo1x0_.type as type3_0_0_ from user_info userinfo1x0_ where userinfo1x0_.id=?
2024-09-10 11:51:00.035 TRACE 906 --- [nio-8090-exec-1] .i.SessionFactoryImpl$SessionBuilderImpl : Opening Hibernate Session.  tenant=null
2024-09-10 11:51:00.036 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : Opened Session [5d4df513-55db-4b2a-8a44-f707240e5ccd] at timestamp: 1725940260035
Hibernate: select userinfo2x0_.id as id1_0_0_, userinfo2x0_.name as name2_0_0_, userinfo2x0_.type as type3_0_0_ from user_info userinfo2x0_ where userinfo2x0_.id=?
2024-09-10 11:51:00.038 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : Closing session [1d911323-5d78-4bd0-9935-ee3a72ad8ecb]
2024-09-10 11:51:00.039 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : Closing session [5d4df513-55db-4b2a-8a44-f707240e5ccd]
2024-09-10 11:51:00.039 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : SessionImpl#beforeTransactionCompletion()
2024-09-10 11:51:00.039 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : Automatically flushing session
Hibernate: insert into user_info (name, type, id) values (?, ?, ?)
2024-09-10 11:51:00.047 DEBUG 906 --- [nio-8090-exec-1] o.h.e.t.internal.TransactionImpl         : TransactionImpl created on closed Session/EntityManager
2024-09-10 11:51:00.047 DEBUG 906 --- [nio-8090-exec-1] o.h.e.t.internal.TransactionImpl         : On TransactionImpl creation, JpaCompliance#isJpaTransactionComplianceEnabled == false
2024-09-10 11:51:00.047 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : SessionImpl#beforeTransactionCompletion()
2024-09-10 11:51:00.047 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : Automatically flushing session
Hibernate: insert into user_info (name, type, id) values (?, ?, ?)
2024-09-10 11:51:00.048 DEBUG 906 --- [nio-8090-exec-1] o.h.e.t.internal.TransactionImpl         : TransactionImpl created on closed Session/EntityManager
2024-09-10 11:51:00.048 DEBUG 906 --- [nio-8090-exec-1] o.h.e.t.internal.TransactionImpl         : On TransactionImpl creation, JpaCompliance#isJpaTransactionComplianceEnabled == false
2024-09-10 11:51:00.059 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : SessionImpl#afterTransactionCompletion(successful=true, delayed=false)
2024-09-10 11:51:00.059 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : Automatically closing session
2024-09-10 11:51:00.059 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : Closing session [1d911323-5d78-4bd0-9935-ee3a72ad8ecb]
2024-09-10 11:51:00.060 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : SessionImpl#afterTransactionCompletion(successful=true, delayed=false)
2024-09-10 11:51:00.060 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : Automatically closing session
2024-09-10 11:51:00.060 TRACE 906 --- [nio-8090-exec-1] org.hibernate.internal.SessionImpl       : Closing session [5d4df513-55db-4b2a-8a44-f707240e5ccd]

### 查询新增的数据
curl -X GET &quot;localhost:8090/db1&quot;
[&#123;&quot;id&quot;:1,&quot;name&quot;:&quot;Sam&quot;,&quot;type&quot;:&quot;dataSource1&quot;&#125;]
curl -X GET &quot;localhost:8090/db2&quot;
[&#123;&quot;id&quot;:1,&quot;name&quot;:&quot;Meir&quot;,&quot;type&quot;:&quot;dataSource2&quot;&#125;]
</code></pre>
<h2 id="9、测试多数据源异常情况-1"><a href="#9、测试多数据源异常情况-1" class="headerlink" title="9、测试多数据源异常情况"></a>9、测试多数据源异常情况</h2><pre><code class="bash">### 执行新增数据异常操作
curl -X GET &quot;localhost:8090/testError&quot;
&#123;&quot;timestamp&quot;:&quot;2024-09-10T03:54:56.103+00:00&quot;,&quot;status&quot;:500,&quot;error&quot;:&quot;Internal Server Error&quot;,&quot;path&quot;:&quot;/testError&quot;&#125;
### 控制台输出
2024-09-10 11:54:56.042 TRACE 906 --- [nio-8090-exec-8] .i.SessionFactoryImpl$SessionBuilderImpl : Opening Hibernate Session.  tenant=null
2024-09-10 11:54:56.043 TRACE 906 --- [nio-8090-exec-8] org.hibernate.internal.SessionImpl       : Opened Session [b708f76a-dcd9-4913-9707-8100e4da037c] at timestamp: 1725940496043
Hibernate: select userinfo1x0_.id as id1_0_0_, userinfo1x0_.name as name2_0_0_, userinfo1x0_.type as type3_0_0_ from user_info userinfo1x0_ where userinfo1x0_.id=?
2024-09-10 11:54:56.048 TRACE 906 --- [nio-8090-exec-8] .i.SessionFactoryImpl$SessionBuilderImpl : Opening Hibernate Session.  tenant=null
2024-09-10 11:54:56.048 TRACE 906 --- [nio-8090-exec-8] org.hibernate.internal.SessionImpl       : Opened Session [d6322714-5766-4b15-9e67-023e39baf276] at timestamp: 1725940496048
Hibernate: select userinfo2x0_.id as id1_0_0_, userinfo2x0_.name as name2_0_0_, userinfo2x0_.type as type3_0_0_ from user_info userinfo2x0_ where userinfo2x0_.id=?
2024-09-10 11:54:56.054 TRACE 906 --- [nio-8090-exec-8] org.hibernate.internal.SessionImpl       : Closing session [b708f76a-dcd9-4913-9707-8100e4da037c]
2024-09-10 11:54:56.055 TRACE 906 --- [nio-8090-exec-8] org.hibernate.internal.SessionImpl       : Closing session [d6322714-5766-4b15-9e67-023e39baf276]
2024-09-10 11:54:56.058 TRACE 906 --- [nio-8090-exec-8] org.hibernate.internal.SessionImpl       : SessionImpl#afterTransactionCompletion(successful=false, delayed=false)
2024-09-10 11:54:56.074 DEBUG 906 --- [nio-8090-exec-8] o.h.e.t.internal.TransactionImpl         : TransactionImpl created on closed Session/EntityManager
2024-09-10 11:54:56.074 DEBUG 906 --- [nio-8090-exec-8] o.h.e.t.internal.TransactionImpl         : On TransactionImpl creation, JpaCompliance#isJpaTransactionComplianceEnabled == false
2024-09-10 11:54:56.075 TRACE 906 --- [nio-8090-exec-8] org.hibernate.internal.SessionImpl       : Automatically closing session
2024-09-10 11:54:56.075 TRACE 906 --- [nio-8090-exec-8] org.hibernate.internal.SessionImpl       : Closing session [b708f76a-dcd9-4913-9707-8100e4da037c]
2024-09-10 11:54:56.075 TRACE 906 --- [nio-8090-exec-8] org.hibernate.internal.SessionImpl       : SessionImpl#afterTransactionCompletion(successful=false, delayed=false)
2024-09-10 11:54:56.075 DEBUG 906 --- [nio-8090-exec-8] o.h.e.t.internal.TransactionImpl         : TransactionImpl created on closed Session/EntityManager
2024-09-10 11:54:56.075 DEBUG 906 --- [nio-8090-exec-8] o.h.e.t.internal.TransactionImpl         : On TransactionImpl creation, JpaCompliance#isJpaTransactionComplianceEnabled == false
2024-09-10 11:54:56.075 TRACE 906 --- [nio-8090-exec-8] org.hibernate.internal.SessionImpl       : Automatically closing session
2024-09-10 11:54:56.075 TRACE 906 --- [nio-8090-exec-8] org.hibernate.internal.SessionImpl       : Closing session [d6322714-5766-4b15-9e67-023e39baf276]
2024-09-10 11:54:56.095 ERROR 906 --- [nio-8090-exec-8] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.ArithmeticException: / by zero] with root cause

### 查询数据, 看看是否有回滚
curl -X GET &quot;localhost:8090/db1&quot;
[&#123;&quot;id&quot;:1,&quot;name&quot;:&quot;Sam&quot;,&quot;type&quot;:&quot;dataSource1&quot;&#125;]
curl -X GET &quot;localhost:8090/db2&quot;
[&#123;&quot;id&quot;:1,&quot;name&quot;:&quot;Meir&quot;,&quot;type&quot;:&quot;dataSource2&quot;&#125;]
</code></pre>
<h1 id="参考文献-鸣谢"><a href="#参考文献-鸣谢" class="headerlink" title="参考文献 &amp; 鸣谢"></a>参考文献 &amp; 鸣谢</h1><ul>
<li>Spring Boot+Atomikos进行多数据源的分布式事务管理详解和实例：<a target="_blank" rel="noopener" href="https://blog.csdn.net/wangshuai6707/article/details/132481113">https://blog.csdn.net/wangshuai6707/article/details/132481113</a></li>
<li>SpringBoot 整合 Atomikos：<a target="_blank" rel="noopener" href="https://blog.51cto.com/amadeusliu/6065259">https://blog.51cto.com/amadeusliu/6065259</a></li>
<li>SpringBoot2使用JTA组件实现基于JdbcTemplate多数据源事务管理(亲测好用)：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/pypua/p/16528031.html">https://www.cnblogs.com/pypua/p/16528031.html</a></li>
<li>SpringBoot的多数据源以及事务解决方案(上篇)：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/hellobluecode/p/17946321">https://www.cnblogs.com/hellobluecode/p/17946321</a></li>
<li>SpringBoot的多数据源以及事务解决方案(下篇)：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/hellobluecode/p/17949897">https://www.cnblogs.com/hellobluecode/p/17949897</a></li>
</ul>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 8629303@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">赏</a>
</p>






    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2017-2024 Sam
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>喜欢就点赞,疼爱就打赏</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/blog/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/blog/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">支付宝</label></span><span><label><input type="radio" name="pay" value="weixin">微信</label></span>
    </div>
</div>


</body>
<script src="/blog/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/blog/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().trim().split('\n').length, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 18px 3px 15px 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: #fafafa;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 582px;
    }
    .nav.fullscreen {
        margin-left: -582px;
    }
    .nav-left {
        width: 160px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
